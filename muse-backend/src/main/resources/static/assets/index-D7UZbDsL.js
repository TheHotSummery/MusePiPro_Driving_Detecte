const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AlertCenter-B97TkA5U.js","assets/vendor-BleAlWPf.js","assets/element-DCn9y4rn.js","assets/charts-TxDtCNV3.js","assets/AlertCenter-BHcmqX6g.css","assets/Analytics-y_hVxKiQ.js","assets/Analytics-BuwrQ4Ir.css","assets/UserManagement-PX_9j0gP.js","assets/UserManagement-DKxOPfbl.css","assets/WebSocketTest-DzX1Zugj.js","assets/WebSocketTest-Cuq8cH5p.css","assets/MapConfigHelp-C8lT4Bfa.js","assets/MapConfigHelp-IbllU7-j.css"])))=>i.map(i=>d[i]);
import{r as F,c as Q,ax as vn,h as Ve,U as We,z as H,A as L,R as a,J as c,al as D,B as l,u as j,I as ue,O as M,P as S,M as ft,E as Te,L as ae,j as Re,n as hn,ad as It,ay as ht,az as Nt,ar as Ut,Q as Le,a6 as Pe,D as ro,K as zt,W as gn,aA as io,aB as co,au as uo,aC as fo}from"./vendor-BleAlWPf.js";import{m as yn,w as po,b as xt,a as mo,s as vo,i as ho,c as Bt,d as go,u as yo,e as _o,f as _n,g as wo,l as wn,E as ie,r as De,h as bo,j as So,k as bn,v as Eo,n as Io,o as Co,p as To,q as ko,t as Ao}from"./element-DCn9y4rn.js";import{u as Sn,E as En,i as In,a as xo,b as Cn,c as Tn,d as kn,e as An,f as Do,g as Oo,h as Mo}from"./charts-TxDtCNV3.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();class $o{constructor(){this.socket=null,this.stompClient=null,this.isConnected=!1,this.reconnectAttempts=0,this.maxReconnectAttempts=6,this.reconnectInterval=5e3,this.longPauseInterval=1e4,this.listeners=new Map,this.isInLongPause=!1}connect(){let t="http://spacemit.topcoder.fun/websocket";t.startsWith("ws://")?t=t.replace("ws://","http://"):t.startsWith("wss://")?t=t.replace("wss://","https://"):!t.startsWith("http://")&&!t.startsWith("https://")&&(t=(window.location.protocol==="https:"?"https://":"http://")+t.replace(/^https?:\/\//,"")),console.log("SockJSè¿æ¥URL:",t);try{this.loadDependencies().then(()=>{this.createSTOMPConnection(t)}).catch(n=>{console.error("åŠ è½½ä¾èµ–å¤±è´¥:",n),this.emit("error",n)})}catch(n){console.error("WebSocketè¿æ¥å¤±è´¥:",n),this.emit("error",n);return}}loadDependencies(){return new Promise((t,n)=>{const o=[];if(window.SockJS||o.push(this.loadScript("https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js")),window.Stomp||o.push(this.loadScript("https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js")),o.length===0){t();return}Promise.all(o).then(t).catch(n)})}loadScript(t){return new Promise((n,o)=>{const s=document.createElement("script");s.src=t,s.onload=n,s.onerror=o,document.head.appendChild(s)})}createSTOMPConnection(t){try{console.log("åˆ›å»ºSTOMPè¿æ¥:",t),this.socket=new window.SockJS(t),this.stompClient=window.Stomp.over(this.socket),this.stompClient.debug=null,this.stompClient.connect({},n=>{console.log("WebSocketè¿æ¥æˆåŠŸ:",n),this.isConnected=!0,this.resetReconnectState(),this.subscribeToTopics(),this.emit("connected",n)},n=>{console.error("WebSocketè¿æ¥å¤±è´¥:",n),this.isConnected=!1,this.handleReconnect()})}catch(n){console.error("STOMPè¿æ¥å¤±è´¥:",n),this.emit("error",n)}}subscribeToTopics(){console.log("å¼€å§‹è®¢é˜…WebSocketä¸»é¢˜..."),this.stompClient.subscribe("/topic/realtime_data",t=>{try{const n=JSON.parse(t.body);console.log("æ”¶åˆ°å®æ—¶æ•°æ®æ¨é€:",n),this.emit("realtime_data",n)}catch(n){console.error("è§£æå®æ—¶æ•°æ®å¤±è´¥:",n)}}),this.stompClient.subscribe("/topic/device_status",t=>{try{const n=JSON.parse(t.body);console.log("æ”¶åˆ°è®¾å¤‡çŠ¶æ€æ›´æ–°:",n),this.emit("device_status",n)}catch(n){console.error("è§£æè®¾å¤‡çŠ¶æ€æ›´æ–°å¤±è´¥:",n)}}),this.stompClient.subscribe("/topic/alert",t=>{try{const n=JSON.parse(t.body);console.log("æ”¶åˆ°å‘Šè­¦æ¨é€:",n),this.emit("alert",n)}catch(n){console.error("è§£æå‘Šè­¦æ¨é€å¤±è´¥:",n)}}),this.stompClient.subscribe("/topic/event",t=>{try{const n=JSON.parse(t.body);console.log("æ”¶åˆ°äº‹ä»¶é€šçŸ¥:",n),this.emit("event",n)}catch(n){console.error("è§£æäº‹ä»¶é€šçŸ¥å¤±è´¥:",n)}}),console.log("WebSocketä¸»é¢˜è®¢é˜…å®Œæˆ")}handleReconnect(){this.reconnectAttempts<this.maxReconnectAttempts?(this.reconnectAttempts++,this.reconnectAttempts===4&&!this.isInLongPause?(this.isInLongPause=!0,console.log(`ç¬¬${this.reconnectAttempts}æ¬¡é‡è¿å¤±è´¥ï¼Œæš‚åœ${this.longPauseInterval/1e3}ç§’åç»§ç»­é‡è¿`),setTimeout(()=>{this.isInLongPause=!1,this.connect()},this.longPauseInterval)):this.reconnectAttempts<=3?(console.log(`å°è¯•é‡è¿ (${this.reconnectAttempts}/${this.maxReconnectAttempts})`),setTimeout(()=>{this.connect()},this.reconnectInterval)):(console.log(`å°è¯•é‡è¿ (${this.reconnectAttempts}/${this.maxReconnectAttempts})`),setTimeout(()=>{this.connect()},this.reconnectInterval))):(console.error("è¾¾åˆ°æœ€å¤§é‡è¿æ¬¡æ•°ï¼Œåœæ­¢é‡è¿"),this.emit("max_reconnect_attempts"))}disconnect(){this.stompClient&&this.isConnected&&this.stompClient.disconnect(()=>{console.log("WebSocketè¿æ¥å·²æ–­å¼€"),this.isConnected=!1,this.emit("disconnected")})}send(t,n,o={}){this.stompClient&&this.isConnected?this.stompClient.send(t,o,JSON.stringify(n)):console.warn("WebSocketæœªè¿æ¥ï¼Œæ— æ³•å‘é€æ¶ˆæ¯")}on(t,n){this.listeners.has(t)||this.listeners.set(t,[]),this.listeners.get(t).push(n)}off(t,n){if(this.listeners.has(t)){const o=this.listeners.get(t),s=o.indexOf(n);s>-1&&o.splice(s,1)}}emit(t,n){this.listeners.has(t)&&this.listeners.get(t).forEach(o=>{try{o(n)}catch(s){console.error(`äº‹ä»¶å¤„ç†å™¨æ‰§è¡Œå¤±è´¥ (${t}):`,s)}})}resetReconnectState(){this.reconnectAttempts=0,this.isInLongPause=!1,console.log("WebSocketé‡è¿çŠ¶æ€å·²é‡ç½®")}getConnectionStatus(){return{isConnected:this.isConnected,reconnectAttempts:this.reconnectAttempts,maxReconnectAttempts:this.maxReconnectAttempts,isInLongPause:this.isInLongPause}}}const le=new $o,Ce=(e,t)=>{const n=e.__vccOpts||e;for(const[o,s]of t)n[o]=s;return n},Ro={id:"app"},Lo={class:"header-content"},Po={class:"header-actions"},Fo={__name:"App",setup(e){const t=vn(),n=F(!1),o=F(!1),s=F(!1),i=Q(()=>t.path==="/"?"/dashboard":t.path),r=F(new Date().toLocaleString()),p=F("production"),_=F("http://spacemit.topcoder.fun"),u=()=>{n.value=!n.value,document.documentElement.classList.toggle("dark",n.value),localStorage.setItem("theme",n.value?"dark":"light")},d=()=>{o.value=!0},w=b=>{const f={analytics:"/analytics",users:"/users","websocket-test":"/websocket-test"};f[b]&&(window.location.href=f[b])},T=b=>{s.value=b};return Ve(()=>{localStorage.getItem("theme")==="dark"&&(n.value=!0,document.documentElement.classList.add("dark")),le.on("connected",()=>T(!0)),le.on("disconnected",()=>T(!1)),s.value=le.getConnectionStatus().isConnected}),We(()=>{le.off("connected",T),le.off("disconnected",T)}),(b,f)=>{const m=D("el-icon"),y=D("el-menu-item"),x=D("el-menu"),O=D("el-button"),N=D("el-dropdown-item"),U=D("el-dropdown-menu"),K=D("el-dropdown"),J=D("el-header"),Z=D("RouterView"),oe=D("el-main"),se=D("el-descriptions-item"),me=D("el-tag"),ye=D("el-descriptions"),be=D("el-dialog");return L(),H("div",Ro,[a(J,{class:"app-header"},{default:c(()=>[l("div",Lo,[f[8]||(f[8]=l("div",{class:"logo"},[l("h1",null,"Muse äº‘ç«¯å®æ—¶æ£€æµ‹å¹³å°")],-1)),a(x,{"default-active":i.value,mode:"horizontal",router:"",class:"header-menu"},{default:c(()=>[a(y,{index:"/dashboard"},{default:c(()=>[a(m,null,{default:c(()=>[a(j(yn))]),_:1}),f[1]||(f[1]=l("span",null,"å®æ—¶ç›‘æ§",-1))]),_:1}),a(y,{index:"/events"},{default:c(()=>[a(m,null,{default:c(()=>[a(j(po))]),_:1}),f[2]||(f[2]=l("span",null,"äº‹ä»¶ä¸­å¿ƒ",-1))]),_:1}),a(y,{index:"/alerts"},{default:c(()=>[a(m,null,{default:c(()=>[a(j(xt))]),_:1}),f[3]||(f[3]=l("span",null,"å‘Šè­¦ä¸­å¿ƒ",-1))]),_:1})]),_:1},8,["default-active"]),l("div",Po,[a(O,{size:"small",onClick:u},{default:c(()=>[a(m,null,{default:c(()=>[n.value?(L(),ue(j(mo),{key:0})):(L(),ue(j(vo),{key:1}))]),_:1})]),_:1}),a(O,{size:"small",onClick:d},{default:c(()=>[a(m,null,{default:c(()=>[a(j(ho))]),_:1})]),_:1}),a(K,{onCommand:w,trigger:"click"},{dropdown:c(()=>[a(U,null,{default:c(()=>[a(N,{command:"analytics"},{default:c(()=>[a(m,null,{default:c(()=>[a(j(go))]),_:1}),f[5]||(f[5]=M(" æ•°æ®åˆ†æ ",-1))]),_:1}),a(N,{command:"users"},{default:c(()=>[a(m,null,{default:c(()=>[a(j(yo))]),_:1}),f[6]||(f[6]=M(" ç”¨æˆ·ç®¡ç† ",-1))]),_:1}),a(N,{command:"websocket-test"},{default:c(()=>[a(m,null,{default:c(()=>[a(j(_o))]),_:1}),f[7]||(f[7]=M(" è¿æ¥æµ‹è¯• ",-1))]),_:1})]),_:1})]),default:c(()=>[a(O,{size:"small"},{default:c(()=>[a(m,null,{default:c(()=>[a(j(Bt))]),_:1}),f[4]||(f[4]=M(" ç®¡ç† ",-1))]),_:1})]),_:1})])])]),_:1}),a(oe,{class:"app-main"},{default:c(()=>[a(Z)]),_:1}),a(be,{modelValue:o.value,"onUpdate:modelValue":f[0]||(f[0]=ve=>o.value=ve),title:"ç³»ç»Ÿä¿¡æ¯",width:"500px"},{default:c(()=>[a(ye,{column:1,border:""},{default:c(()=>[a(se,{label:"ç³»ç»Ÿç‰ˆæœ¬"},{default:c(()=>[...f[9]||(f[9]=[M("v1.0.0",-1)])]),_:1}),a(se,{label:"æ„å»ºæ—¶é—´"},{default:c(()=>[M(S(r.value),1)]),_:1}),a(se,{label:"è¿è¡Œç¯å¢ƒ"},{default:c(()=>[M(S(p.value),1)]),_:1}),a(se,{label:"APIåœ°å€"},{default:c(()=>[M(S(_.value),1)]),_:1}),a(se,{label:"WebSocketçŠ¶æ€"},{default:c(()=>[a(me,{type:s.value?"success":"danger"},{default:c(()=>[M(S(s.value?"å·²è¿æ¥":"æœªè¿æ¥"),1)]),_:1},8,["type"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},No=Ce(Fo,[["__scopeId","data-v-ff617af4"]]),Uo="modulepreload",zo=function(e){return"/"+e},Qt={},Je=function(t,n,o){let s=Promise.resolve();if(n&&n.length>0){let _=function(u){return Promise.all(u.map(d=>Promise.resolve(d).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),p=r?.nonce||r?.getAttribute("nonce");s=_(n.map(u=>{if(u=zo(u),u in Qt)return;Qt[u]=!0;const d=u.endsWith(".css"),w=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${w}`))return;const T=document.createElement("link");if(T.rel=d?"stylesheet":Uo,d||(T.as="script"),T.crossOrigin="",T.href=u,p&&T.setAttribute("nonce",p),document.head.appendChild(T),d)return new Promise((b,f)=>{T.addEventListener("load",b),T.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(r){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=r,window.dispatchEvent(p),!p.defaultPrevented)throw r}return s.then(r=>{for(const p of r||[])p.status==="rejected"&&i(p.reason);return t().catch(i)})},Bo={class:"stat-content"},Ho={class:"stat-value"},Vo={class:"stat-label"},Wo={key:0,class:"stat-trend"},jo={__name:"StatCard",props:{title:{type:String,required:!0},value:{type:[Number,String],required:!0},icon:{type:String,required:!0},color:{type:String,default:"primary",validator:e=>["primary","success","warning","danger","info"].includes(e)},suffix:{type:String,default:""},trend:{type:Number,default:void 0},pulse:{type:Boolean,default:!1},highlight:{type:Boolean,default:!1},urgent:{type:Boolean,default:!1}},setup(e){const t=e,n=Q(()=>typeof t.value=="number"?t.value.toLocaleString():t.value),o=Q(()=>`stat-card--${t.color}${t.pulse?" stat-card--pulse":""}${t.highlight?" stat-card--highlight":""}${t.urgent?" stat-card--urgent":""}`),s=Q(()=>`stat-icon--${t.color}${t.pulse?" stat-icon--pulse":""}${t.highlight?" stat-icon--highlight":""}${t.urgent?" stat-icon--urgent":""}`),i=Q(()=>t.trend>0?"trend-up":"trend-down");return(r,p)=>{const _=D("el-icon");return L(),H("div",{class:Te(["stat-card",o.value])},[l("div",{class:Te(["stat-icon",s.value])},[a(_,null,{default:c(()=>[(L(),ue(ft(e.icon)))]),_:1})],2),l("div",Bo,[l("div",Ho,S(n.value)+S(e.suffix),1),l("div",Vo,S(e.title),1),e.trend!==void 0?(L(),H("div",Wo,[a(_,{class:Te(i.value)},{default:c(()=>[(L(),ue(ft(e.trend>0?"ArrowUp":"ArrowDown")))]),_:1},8,["class"]),l("span",null,S(Math.abs(e.trend))+"%",1)])):ae("",!0)])],2)}}},rt=Ce(jo,[["__scopeId","data-v-d57b29d8"]]),qo={__name:"DeviceStatusTag",props:{status:{type:String,required:!0,validator:e=>["ONLINE","OFFLINE","LOST"].includes(e)},effect:{type:String,default:"light",validator:e=>["dark","light","plain"].includes(e)}},setup(e){const t=e,n={ONLINE:{type:"success",icon:"CircleCheck",text:"åœ¨çº¿"},OFFLINE:{type:"info",icon:"CircleClose",text:"ç¦»çº¿"},LOST:{type:"danger",icon:"Warning",text:"å¤±è”"}},o=Q(()=>n[t.status]?.type||"info"),s=Q(()=>n[t.status]?.icon||"CircleClose"),i=Q(()=>n[t.status]?.text||"æœªçŸ¥");return(r,p)=>{const _=D("el-icon"),u=D("el-tag");return L(),ue(u,{type:o.value,effect:e.effect,size:"small"},{default:c(()=>[a(_,{class:"status-icon"},{default:c(()=>[(L(),ue(ft(s.value)))]),_:1}),M(" "+S(i.value),1)]),_:1},8,["type","effect"])}}},Dt=Ce(qo,[["__scopeId","data-v-2e81de45"]]),Go={class:"health-progress"},Ko={__name:"HealthProgress",props:{score:{type:Number,required:!0,validator:e=>e>=0&&e<=100}},setup(e){const t=e,n=Q(()=>Math.round(t.score)),o=Q(()=>t.score>=80?"#67C23A":t.score>=60?"#E6A23C":"#F56C6C"),s=Q(()=>t.score>=80?"text-success":t.score>=60?"text-warning":"text-danger");return(i,r)=>{const p=D("el-progress");return L(),H("div",Go,[a(p,{percentage:n.value,color:o.value,"stroke-width":8,"show-text":!1},null,8,["percentage","color"]),l("span",{class:Te(["health-text",s.value])},S(n.value)+"%",3)])}}},Ot=Ce(Ko,[["__scopeId","data-v-ada9c17b"]]),Jo={class:"map-controls"},Yo={key:0,class:"map-error"},Xo={key:1,class:"map-loading"},_e=3.141592653589793,Zt=6378245,en=.006693421622965943,Qo={__name:"SimpleMap",props:{devices:{type:Array,default:()=>[]},center:{type:Object,default:()=>({lat:33.553733,lng:119.030953})},zoom:{type:Number,default:10}},emits:["device-click","map-ready"],setup(e,{expose:t,emit:n}){const o=e,s=n,i=F(null),r=F(!1),p=F(""),_=F("");let u=null,d=[],w=null,T=new Map,b=1e-4;function f(k,$){let E=-100+2*k+3*$+.2*$*$+.1*k*$+.2*Math.sqrt(Math.abs(k));return E+=(20*Math.sin(6*k*_e)+20*Math.sin(2*k*_e))*2/3,E+=(20*Math.sin($*_e)+40*Math.sin($/3*_e))*2/3,E+=(160*Math.sin($/12*_e)+320*Math.sin($*_e/30))*2/3,E}function m(k,$){let E=300+k+2*$+.1*k*k+.1*k*$+.1*Math.sqrt(Math.abs(k));return E+=(20*Math.sin(6*k*_e)+20*Math.sin(2*k*_e))*2/3,E+=(20*Math.sin(k*_e)+40*Math.sin(k/3*_e))*2/3,E+=(150*Math.sin(k/12*_e)+300*Math.sin(k/30*_e))*2/3,E}function y(k,$){return k<72.004||k>137.8347||$<.8293||$>55.8271||!1}function x(k,$){if(y(k,$))return[k,$];{let E=f(k-105,$-35),A=m(k-105,$-35);const R=$/180*_e;let z=Math.sin(R);z=1-en*z*z;const Y=Math.sqrt(z);E=E*180/(Zt*(1-en)/(z*Y)*_e),A=A*180/(Zt/Y*Math.cos(R)*_e);const X=$+E;return[k+A,X]}}const O=F(""),N=()=>{const k="732a364f70864bb0c4ac3395cc3d5503";localStorage.getItem("amap_api_key"),O.value=k},U=async()=>{if(console.log("å¼€å§‹åˆå§‹åŒ–åœ°å›¾..."),console.log("API Key:",O.value?"å·²é…ç½®":"æœªé…ç½®"),console.log("åœ°å›¾å®¹å™¨:",i.value),!O.value){p.value="é«˜å¾·åœ°å›¾API keyæœªé…ç½®";return}if(!i.value){p.value="åœ°å›¾å®¹å™¨æœªæ‰¾åˆ°";return}r.value=!0,p.value="";try{if(window.AMap||(console.log("åŠ è½½é«˜å¾·åœ°å›¾API..."),await K()),!window.AMap)throw new Error("é«˜å¾·åœ°å›¾APIåŠ è½½å¤±è´¥");console.log("AMapå·²åŠ è½½ï¼Œå¼€å§‹åˆ›å»ºåœ°å›¾å®ä¾‹..."),console.log("åœ°å›¾å®¹å™¨å°ºå¯¸:",i.value.offsetWidth,"x",i.value.offsetHeight),u=new window.AMap.Map(i.value,{center:[o.center.lng,o.center.lat],zoom:o.zoom,mapStyle:"amap://styles/normal"}),console.log("åœ°å›¾å®ä¾‹åˆ›å»ºæˆåŠŸ"),w=new window.AMap.InfoWindow({offset:new window.AMap.Pixel(0,-30)}),u.on("complete",()=>{console.log("åœ°å›¾åŠ è½½å®Œæˆ"),u.on("click",()=>{w&&w.close()}),s("map-ready",u),oe(),r.value=!1})}catch(k){console.error("åœ°å›¾åˆå§‹åŒ–å¤±è´¥:",k),p.value=k.message||"åœ°å›¾åˆå§‹åŒ–å¤±è´¥",r.value=!1}},K=()=>new Promise((k,$)=>{if(window.AMap){k();return}const E=localStorage.getItem("amap_version")||"1.4.15",A=document.createElement("script");A.src=`https://webapi.amap.com/maps?v=${E}&key=${O.value}`,A.onload=()=>{const R=()=>{window.AMap&&window.AMap.Map?k():setTimeout(R,100)};R()},A.onerror=()=>{$(new Error("é«˜å¾·åœ°å›¾APIåŠ è½½å¤±è´¥"))},document.head.appendChild(A)}),J=k=>{const $=[],E=[];return k.forEach(A=>{const R=It(A)||A;if(R.location&&R.location.lat&&R.location.lng){const z=R.deviceId,Y={lat:R.location.lat,lng:R.location.lng};if(R.status==="ONLINE"&&E.push(R),T.has(z)){const X=T.get(z),pe=Math.abs(Y.lat-X.lat),Se=Math.abs(Y.lng-X.lng);(pe>b||Se>b)&&(console.log(`è®¾å¤‡ ${z} ä½ç½®å‘ç”Ÿå˜åŒ–:`,{from:X,to:Y,latDiff:pe,lngDiff:Se}),$.push(R))}else console.log(`æ–°è®¾å¤‡ ${z} é¦–æ¬¡å‡ºç°`),$.push(R);T.set(z,Y)}}),{changedDevices:$,onlineDevices:E}},Z=k=>{if(k.length===0)return;const $=k.filter(E=>E.status==="ONLINE");if($.length>0){console.log("è‡ªåŠ¨èšç„¦åˆ°ä½ç½®å˜åŒ–çš„åœ¨çº¿è®¾å¤‡:",$.map(A=>A.deviceId));const E=d.filter(A=>{const R=A.getTitle().split(" - ")[0];return $.some(z=>z.deviceId===R)});E.length>0&&(u.setFitView(E,!1,[50,50,50,50]),E.forEach(A=>{A.setAnimation("AMAP_ANIMATION_BOUNCE"),setTimeout(()=>{A.setAnimation(null)},2e3)}))}},oe=()=>{if(!u)return;console.log("=== æ›´æ–°åœ°å›¾æ ‡è®° ==="),console.log("æ‰€æœ‰è®¾å¤‡:",o.devices),console.log("å½“å‰ç­›é€‰çŠ¶æ€:",_.value);const{changedDevices:k}=J(o.devices);d.forEach(E=>u.remove(E)),d=[];const $=o.devices.filter(E=>{const A=It(E)||E;if(console.log(`æ£€æŸ¥è®¾å¤‡ ${A.deviceId}:`,{status:A.status,hasLocation:!!(A.location&&A.location.lat&&A.location.lng),location:A.location}),_.value&&A.status!==_.value)return console.log(`è®¾å¤‡ ${A.deviceId} çŠ¶æ€ä¸åŒ¹é…ï¼Œè·³è¿‡`),!1;const R=A.location&&A.location.lat&&A.location.lng;return R||console.log(`è®¾å¤‡ ${A.deviceId} æ²¡æœ‰æœ‰æ•ˆä½ç½®ä¿¡æ¯ï¼Œè·³è¿‡`),R});console.log("ç­›é€‰åçš„è®¾å¤‡:",$),$.forEach((E,A)=>{const R=It(E)||E;if(R.location&&R.location.lat&&R.location.lng){const[z,Y]=x(R.location.lng,R.location.lat),X=k.some(Se=>Se.deviceId===R.deviceId),pe=new window.AMap.Marker({position:[z,Y],title:`${R.deviceId} - ${R.username||"æœªçŸ¥ç”¨æˆ·"}`,icon:se(R.status,A,X),anchor:"center",label:{content:`${R.deviceId}<br/>${R.username||"æœªçŸ¥ç”¨æˆ·"}<br/>${me(R.status)}${X?"<br/>ğŸ“ ä½ç½®æ›´æ–°":""}`,direction:"bottom",offset:new window.AMap.Pixel(0,10),style:{backgroundColor:X?"#FF6B6B":ye(R.status),color:"#fff",fontSize:"12px",padding:"4px 8px",borderRadius:"4px",border:"1px solid #fff"}}});pe.on("click",()=>{be(R,pe),s("device-click",R)}),d.push(pe),u.add(pe)}}),Z(k),k.length===0&&$.length>0&&u.setFitView(d)},se=(k,$,E=!1)=>{const A=["#67C23A","#E6A23C","#F56C6C","#409EFF","#909399","#9C27B0","#FF9800","#4CAF50"];let R=A[$%A.length];return E&&(R="#FF6B6B"),new window.AMap.Icon({size:new window.AMap.Size(32,32),image:`data:image/svg+xml;base64,${btoa(`
      <svg width="32" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
        <circle cx="16" cy="16" r="12" fill="${R}" stroke="#fff" stroke-width="2"/>
        <circle cx="16" cy="16" r="4" fill="#fff"/>
        <text x="16" y="20" text-anchor="middle" fill="#fff" font-size="8" font-weight="bold">${$+1}</text>
        ${E?'<circle cx="16" cy="16" r="14" fill="none" stroke="#FF6B6B" stroke-width="3" opacity="0.8"/>':""}
      </svg>
    `)}`,imageSize:new window.AMap.Size(32,32)})},me=k=>({ONLINE:"åœ¨çº¿",OFFLINE:"ç¦»çº¿",LOST:"å¤±è”"})[k]||"æœªçŸ¥",ye=k=>({ONLINE:"#67C23A",OFFLINE:"#909399",LOST:"#F56C6C"})[k]||"#909399",be=(k,$)=>{const[E,A]=x(k.location.lng,k.location.lat),R=k.status==="ONLINE",z=`
    <div class="device-info-window">
      <h4>${k.deviceId}</h4>
      <p><strong>é©¾é©¶å‘˜:</strong> ${k.username||"æœªçŸ¥"}</p>
      <p><strong>çŠ¶æ€:</strong> <span style="color: ${ye(k.status)}">${me(k.status)}</span></p>
      <p><strong>ç½‘ç»œå¥åº·çŠ¶æ€:</strong> ${k.healthScore||0}%</p>
      <p><strong>æœ€åå¿ƒè·³:</strong> ${ve(k.lastSeen)}</p>
      
      ${R?`
        <hr style="margin: 8px 0;">
        <p><strong>å®æ—¶ä¿¡æ¯:</strong></p>
        <p><strong>é€Ÿåº¦:</strong> ${k.location.speed||0} km/h</p>
        <p><strong>æ–¹å‘:</strong> ${k.location.direction||0}Â°</p>
        <p><strong>å«æ˜Ÿæ•°:</strong> ${k.location.satellites||0}</p>
        <p><strong>æµ·æ‹”:</strong> ${k.location.altitude||0} m</p>
        <p><strong>ç²¾åº¦:</strong> ${k.location.hdop||0}</p>
      `:`
        <hr style="margin: 8px 0;">
        <p style="color: #909399; font-style: italic;">è®¾å¤‡ç¦»çº¿ï¼Œå®æ—¶ä¿¡æ¯ä¸å¯ç”¨</p>
      `}
      
      <hr style="margin: 8px 0;">
      <p><strong>åŸå§‹åæ ‡ (WGS-84):</strong></p>
      <p>ç»åº¦: ${k.location.lng.toFixed(6)}</p>
      <p>çº¬åº¦: ${k.location.lat.toFixed(6)}</p>
      <p><strong>æ ¡å‡†åæ ‡ (GCJ-02):</strong></p>
      <p>ç»åº¦: ${E.toFixed(6)}</p>
      <p>çº¬åº¦: ${A.toFixed(6)}</p>
    </div>
  `;w.setContent(z),w.open(u,$.getPosition())},ve=k=>{if(!k)return"æœªçŸ¥";const $=new Date(k),A=new Date-$,R=Math.floor(A/6e4);if(R<1)return"åˆšåˆš";if(R<60)return`${R}åˆ†é’Ÿå‰`;const z=Math.floor(R/60);return z<24?`${z}å°æ—¶å‰`:$.toLocaleDateString()},I=()=>{u&&o.devices.length>0?u.setFitView(d):u&&u.setCenter([o.center.lng,o.center.lat])},v=()=>{i.value.requestFullscreen&&i.value.requestFullscreen()},te=()=>{p.value="",u&&(u.destroy(),u=null),U()},ne=()=>{console.log("å¼ºåˆ¶åˆ·æ–°åœ°å›¾..."),u&&(u.destroy(),u=null),d=[],setTimeout(()=>{U()},100)};return Re(()=>o.devices,oe,{deep:!0}),Re(()=>O.value,k=>{k&&!u&&U()}),Ve(()=>{N(),hn(()=>{O.value&&U()})}),We(()=>{u&&u.destroy()}),t({centerMap:I,updateMarkers:oe,forceRefresh:ne,getMap:()=>u}),(k,$)=>{const E=D("el-option"),A=D("el-select"),R=D("el-icon"),z=D("el-button"),Y=D("el-button-group"),X=D("el-alert");return L(),H("div",{class:"simple-map",ref_key:"mapContainer",ref:i},[l("div",Jo,[a(A,{modelValue:_.value,"onUpdate:modelValue":$[0]||($[0]=pe=>_.value=pe),placeholder:"ç­›é€‰è®¾å¤‡çŠ¶æ€",size:"small",clearable:"",style:{"margin-right":"10px",width:"150px"},onChange:oe},{default:c(()=>[a(E,{label:"å…¨éƒ¨è®¾å¤‡",value:""}),a(E,{label:"åœ¨çº¿è®¾å¤‡",value:"ONLINE"}),a(E,{label:"ç¦»çº¿è®¾å¤‡",value:"OFFLINE"}),a(E,{label:"å¤±è”è®¾å¤‡",value:"LOST"})]),_:1},8,["modelValue"]),a(Y,null,{default:c(()=>[a(z,{size:"small",onClick:I},{default:c(()=>[a(R,null,{default:c(()=>[a(j(_n))]),_:1}),$[1]||($[1]=M(" å±…ä¸­ ",-1))]),_:1}),a(z,{size:"small",onClick:v},{default:c(()=>[a(R,null,{default:c(()=>[a(j(wo))]),_:1}),$[2]||($[2]=M(" å…¨å± ",-1))]),_:1})]),_:1})]),p.value?(L(),H("div",Yo,[a(X,{title:"åœ°å›¾åŠ è½½å¤±è´¥",description:p.value,type:"error","show-icon":"",closable:!1},null,8,["description"]),a(z,{onClick:te,style:{"margin-top":"10px"}},{default:c(()=>[...$[3]||($[3]=[M("é‡è¯•",-1)])]),_:1})])):ae("",!0),r.value?(L(),H("div",Xo,[a(R,{class:"is-loading"},{default:c(()=>[a(j(wn))]),_:1}),$[4]||($[4]=l("span",null,"åœ°å›¾åŠ è½½ä¸­...",-1))])):ae("",!0)],512)}}},Zo=Ce(Qo,[["__scopeId","data-v-befe318e"]]),es={class:"event-trend-chart"},ts={class:"chart-header"},ns={__name:"EventTrendChart",props:{data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["period-change"],setup(e,{emit:t}){Sn([In,xo,Cn,Tn,kn,An,Do]);const n=e,o=t,s=F("today"),i=Q(()=>{const d=["FATIGUE","DISTRACTION","EMERGENCY"],w=["#FF8C00","#DC143C","#32CD32"],T=r();return{title:{text:"äº‹ä»¶è¶‹åŠ¿",left:"center",textStyle:{fontSize:16,fontWeight:"bold",color:"#303133"}},tooltip:{trigger:"axis",axisPointer:{type:"cross",lineStyle:{color:"#999",width:1}},backgroundColor:"rgba(0, 0, 0, 0.8)",borderColor:"#ccc",borderWidth:1,textStyle:{color:"#fff"},formatter:function(b){let f=`<div style="margin-bottom: 8px; font-weight: bold; font-size: 14px; color: #fff;">${b[0].axisValue}</div>`;return b.forEach(m=>{const y=m.value||0;f+=`<div style="margin: 4px 0; display: flex; align-items: center;">
            <span style="display: inline-block; width: 12px; height: 12px; background-color: ${m.color}; border-radius: 50%; margin-right: 8px;"></span>
            <span style="color: #fff; font-weight: 500;">${m.seriesName}:</span>
            <span style="color: #fff; font-weight: bold; margin-left: 8px;">${y}</span>
          </div>`}),f}},legend:{data:["ç–²åŠ³äº‹ä»¶","åˆ†å¿ƒäº‹ä»¶","ç´§æ€¥äº‹ä»¶"],top:30,textStyle:{fontSize:12,fontWeight:"bold"}},grid:{left:"3%",right:"4%",bottom:"15%",top:"20%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:T.timeLabels,axisLabel:{rotate:45,color:"#666",fontSize:11},axisLine:{lineStyle:{color:"#ddd"}}},yAxis:{type:"value",name:"äº‹ä»¶æ•°é‡",nameTextStyle:{color:"#666",fontSize:12},axisLabel:{formatter:"{value}",color:"#666",fontSize:11},axisLine:{lineStyle:{color:"#ddd"}},splitLine:{lineStyle:{color:"#f0f0f0",type:"dashed"}}},dataZoom:[{type:"inside",start:0,end:100}],series:d.map((b,f)=>({name:_(b),type:"line",data:T.seriesData[b]||[],smooth:!0,symbol:"circle",symbolSize:8,lineStyle:{width:4},itemStyle:{color:w[f],borderColor:"#fff",borderWidth:2},areaStyle:{opacity:.2,color:w[f]},label:{show:!1,position:"top",formatter:"{c}",fontSize:10,fontWeight:"bold",color:w[f]},emphasis:{focus:"series",itemStyle:{borderColor:"#fff",borderWidth:3,shadowBlur:10,shadowColor:w[f]}}}))}}),r=()=>{if(!n.data.length)return{timeLabels:[],seriesData:{}};const d={},w=["FATIGUE","DISTRACTION","EMERGENCY"];n.data.forEach(f=>{const m=p(f.timestamp);d[m]||(d[m]={}),d[m][f.eventType]||(d[m][f.eventType]=0),d[m][f.eventType]++});const T=Object.keys(d).sort(),b={};return w.forEach(f=>{b[f]=T.map(m=>d[m]?.[f]||0)}),{timeLabels:T,seriesData:b}},p=d=>{const w=new Date(d);switch(s.value){case"today":return`${w.getHours().toString().padStart(2,"0")}:${w.getMinutes().toString().padStart(2,"0")}`;case"week":return`${w.getMonth()+1}/${w.getDate()}`;case"month":return`${w.getMonth()+1}/${w.getDate()}`;default:return w.toLocaleDateString()}},_=d=>({FATIGUE:"ç–²åŠ³äº‹ä»¶",DISTRACTION:"åˆ†å¿ƒäº‹ä»¶",EMERGENCY:"ç´§æ€¥äº‹ä»¶"})[d]||d,u=d=>{o("period-change",d)};return Re(()=>n.data,()=>{},{deep:!0}),(d,w)=>{const T=D("el-option"),b=D("el-select");return L(),H("div",es,[l("div",ts,[w[1]||(w[1]=l("h3",null,"äº‹ä»¶è¶‹åŠ¿åˆ†æ",-1)),a(b,{modelValue:s.value,"onUpdate:modelValue":w[0]||(w[0]=f=>s.value=f),onChange:u,size:"small"},{default:c(()=>[a(T,{label:"ä»Šæ—¥",value:"today"}),a(T,{label:"æœ¬å‘¨",value:"week"}),a(T,{label:"æœ¬æœˆ",value:"month"})]),_:1},8,["modelValue"])]),a(j(En),{class:"chart",option:i.value,loading:e.loading,autoresize:"","canvas-id":"event-trend-chart"},null,8,["option","loading"])])}}},xn=Ce(ns,[["__scopeId","data-v-b1a642fe"]]),os={class:"fatigue-analysis-chart"},ss={class:"chart-header"},as={__name:"FatigueAnalysisChart",props:{data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["type-change"],setup(e,{emit:t}){Sn([In,Oo,Mo,Cn,Tn,kn,An]);const n=e,o=t,s=F("hourly"),i=Q(()=>{switch(s.value){case"hourly":return r();case"severity":return p();case"behavior":return _();default:return r()}}),r=()=>{const b=u();return{title:{text:"ç–²åŠ³äº‹ä»¶å°æ—¶åˆ†å¸ƒ",left:"center",textStyle:{fontSize:16,fontWeight:"bold",color:"#303133"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow",shadowStyle:{color:"rgba(0, 0, 0, 0.1)"}},backgroundColor:"rgba(0, 0, 0, 0.8)",borderColor:"#ccc",borderWidth:1,textStyle:{color:"#fff"},formatter:function(f){const m=f[0];return`<div style="color: #fff; font-weight: bold;">${m.axisValue}:00</div>
                <div style="margin-top: 4px; color: #fff;">
                  <span style="display: inline-block; width: 12px; height: 12px; background-color: ${m.color}; border-radius: 50%; margin-right: 8px;"></span>
                  ç–²åŠ³äº‹ä»¶: <span style="font-weight: bold;">${m.value}</span>
                </div>`}},grid:{left:"3%",right:"4%",bottom:"15%",top:"20%",containLabel:!0},xAxis:{type:"category",data:b.labels,axisLabel:{formatter:"{value}:00",color:"#666",fontSize:11},axisLine:{lineStyle:{color:"#ddd"}}},yAxis:{type:"value",name:"äº‹ä»¶æ•°é‡",nameTextStyle:{color:"#666",fontSize:12},axisLabel:{color:"#666",fontSize:11},axisLine:{lineStyle:{color:"#ddd"}},splitLine:{lineStyle:{color:"#f0f0f0",type:"dashed"}}},series:[{name:"ç–²åŠ³äº‹ä»¶",type:"bar",data:b.values,itemStyle:{color:"#FF8C00",borderRadius:[4,4,0,0]},emphasis:{itemStyle:{color:"#FF7F00",shadowBlur:10,shadowColor:"#FF8C00"}},label:{show:!0,position:"top",formatter:"{c}",fontSize:10,fontWeight:"bold",color:"#FF8C00"}}]}},p=()=>{const b=d();return{title:{text:"ç–²åŠ³äº‹ä»¶ä¸¥é‡ç¨‹åº¦åˆ†å¸ƒ",left:"center",textStyle:{fontSize:16,fontWeight:"bold",color:"#303133"}},tooltip:{trigger:"item",backgroundColor:"rgba(0, 0, 0, 0.8)",borderColor:"#ccc",borderWidth:1,textStyle:{color:"#fff"},formatter:function(f){return`<div style="color: #fff; font-weight: bold;">${f.name}</div>
                <div style="margin-top: 4px; color: #fff;">
                  <span style="display: inline-block; width: 12px; height: 12px; background-color: ${f.color}; border-radius: 50%; margin-right: 8px;"></span>
                  æ•°é‡: <span style="font-weight: bold;">${f.value}</span>
                </div>
                <div style="color: #fff; margin-top: 2px;">å æ¯”: <span style="font-weight: bold;">${f.percent}%</span></div>`}},legend:{orient:"vertical",left:"left",top:"middle",textStyle:{fontSize:12,fontWeight:"bold"}},series:[{name:"ä¸¥é‡ç¨‹åº¦",type:"pie",radius:["40%","70%"],center:["60%","50%"],data:b,emphasis:{itemStyle:{shadowBlur:15,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.3)"},label:{show:!0,fontSize:14,fontWeight:"bold"}},label:{show:!0,formatter:`{b}
{c} ({d}%)`,fontSize:11,fontWeight:"bold"},labelLine:{show:!0,lineStyle:{width:2}}}]}},_=()=>{const b=w();return{title:{text:"ç–²åŠ³è¡Œä¸ºç±»å‹åˆ†å¸ƒ",left:"center",textStyle:{fontSize:16,fontWeight:"bold",color:"#303133"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow",shadowStyle:{color:"rgba(0, 0, 0, 0.1)"}},backgroundColor:"rgba(0, 0, 0, 0.8)",borderColor:"#ccc",borderWidth:1,textStyle:{color:"#fff"},formatter:function(f){const m=f[0];return`<div style="color: #fff; font-weight: bold;">${m.axisValue}</div>
                <div style="margin-top: 4px; color: #fff;">
                  <span style="display: inline-block; width: 12px; height: 12px; background-color: ${m.color}; border-radius: 50%; margin-right: 8px;"></span>
                  è¡Œä¸ºç±»å‹: <span style="font-weight: bold;">${m.value}</span>
                </div>`}},grid:{left:"3%",right:"4%",bottom:"15%",top:"20%",containLabel:!0},xAxis:{type:"category",data:b.labels,axisLabel:{color:"#666",fontSize:11,rotate:45},axisLine:{lineStyle:{color:"#ddd"}}},yAxis:{type:"value",name:"äº‹ä»¶æ•°é‡",nameTextStyle:{color:"#666",fontSize:12},axisLabel:{color:"#666",fontSize:11},axisLine:{lineStyle:{color:"#ddd"}},splitLine:{lineStyle:{color:"#f0f0f0",type:"dashed"}}},series:[{name:"è¡Œä¸ºç±»å‹",type:"bar",data:b.values,itemStyle:{color:"#409EFF",borderRadius:[4,4,0,0]},emphasis:{itemStyle:{color:"#337ECC",shadowBlur:10,shadowColor:"#409EFF"}},label:{show:!0,position:"top",formatter:"{c}",fontSize:10,fontWeight:"bold",color:"#409EFF"}}]}},u=()=>{const b=new Array(24).fill(0);return n.data.forEach(f=>{if(f.eventType==="FATIGUE"){const m=new Date(f.timestamp).getHours();b[m]++}}),{labels:Array.from({length:24},(f,m)=>m),values:b}},d=()=>{const b={LOW:0,MEDIUM:0,HIGH:0,CRITICAL:0};n.data.forEach(y=>{y.eventType==="FATIGUE"&&b.hasOwnProperty(y.severity)&&b[y.severity]++});const f={LOW:"#67C23A",MEDIUM:"#E6A23C",HIGH:"#F56C6C",CRITICAL:"#F56C6C"},m={LOW:"è½»å¾®",MEDIUM:"ä¸­ç­‰",HIGH:"ä¸¥é‡",CRITICAL:"å±æ€¥"};return Object.entries(b).filter(([y,x])=>x>0).map(([y,x])=>({value:x,name:m[y],itemStyle:{color:f[y]}}))},w=()=>{const b={};n.data.forEach(m=>{m.eventType==="FATIGUE"&&m.behavior&&(b[m.behavior]=(b[m.behavior]||0)+1)});const f={EYE_CLOSURE:"é—­çœ¼",YAWNING:"æ‰“å“ˆæ¬ ",HEAD_NODDING:"ç‚¹å¤´",DISTRACTED:"åˆ†å¿ƒ",SLEEPY:"å›°å€¦"};return{labels:Object.keys(b).map(m=>f[m]||m),values:Object.values(b)}},T=b=>{o("type-change",b)};return Re(()=>n.data,()=>{},{deep:!0}),(b,f)=>{const m=D("el-option"),y=D("el-select");return L(),H("div",os,[l("div",ss,[f[1]||(f[1]=l("h3",null,"ç–²åŠ³è¡Œä¸ºåˆ†æ",-1)),a(y,{modelValue:s.value,"onUpdate:modelValue":f[0]||(f[0]=x=>s.value=x),onChange:T,size:"small"},{default:c(()=>[a(m,{label:"å°æ—¶åˆ†å¸ƒ",value:"hourly"}),a(m,{label:"ä¸¥é‡ç¨‹åº¦",value:"severity"}),a(m,{label:"è¡Œä¸ºç±»å‹",value:"behavior"})]),_:1},8,["modelValue"])]),a(j(En),{class:"chart",option:i.value,loading:e.loading,autoresize:"","canvas-id":"fatigue-analysis-chart"},null,8,["option","loading"])])}}},ls=Ce(as,[["__scopeId","data-v-365605af"]]),rs={class:"card-header"},is={class:"device-info"},cs={class:"info-section"},us={class:"info-grid"},ds={class:"info-item"},fs={class:"value"},ps={class:"info-item"},ms={class:"value"},vs={class:"info-item"},hs={class:"value"},gs={class:"info-item"},ys={class:"value"},_s={key:0,class:"info-section"},ws={class:"info-grid"},bs={class:"info-item"},Ss={class:"value"},Es={class:"info-item"},Is={class:"value"},Cs={class:"info-item"},Ts={class:"value"},ks={key:1,class:"info-section"},As={class:"info-grid"},xs={class:"info-item"},Ds={class:"value"},Os={class:"info-item"},Ms={class:"value"},$s={class:"info-item"},Rs={class:"value"},Ls={class:"info-item"},Ps={class:"value"},Fs={key:2,class:"info-section"},Ns={class:"info-grid"},Us={class:"info-item"},zs={class:"value speed-value"},Bs={class:"info-item"},Hs={class:"value direction-value"},Vs={class:"info-item"},Ws={class:"value satellite-value"},js={class:"info-item"},qs={class:"value"},Gs={key:3,class:"info-section"},Ks={key:4,class:"info-section"},Js={class:"info-grid"},Ys={class:"info-item"},Xs={class:"value"},Qs={class:"info-item"},Zs={class:"value"},ea={class:"info-item"},ta={class:"value"},na={class:"info-item"},oa={class:"value"},sa={__name:"DeviceDetailCard",props:{device:{type:Object,required:!0}},setup(e){const t=e,n=Q(()=>t.device.status==="ONLINE"),o=_=>({ONLINE:"success",OFFLINE:"info",LOST:"danger"})[_]||"info",s=_=>({ONLINE:"åœ¨çº¿",OFFLINE:"ç¦»çº¿",LOST:"å¤±è”"})[_]||"æœªçŸ¥",i=_=>_>=80?"#67C23A":_>=60?"#E6A23C":"#F56C6C",r=_=>{if(!_)return"æœªçŸ¥";const u=new Date(_),w=new Date-u,T=Math.floor(w/6e4);if(T<1)return"åˆšåˆš";if(T<60)return`${T}åˆ†é’Ÿå‰`;const b=Math.floor(T/60);return b<24?`${b}å°æ—¶å‰`:u.toLocaleDateString()},p=_=>{if(!_)return"0åˆ†é’Ÿ";const u=Math.floor(_/3600),d=Math.floor(_%3600/60);return u>0?`${u}å°æ—¶${d}åˆ†é’Ÿ`:`${d}åˆ†é’Ÿ`};return(_,u)=>{const d=D("el-tag"),w=D("el-progress"),T=D("el-alert"),b=D("el-card");return L(),ue(b,{class:"device-detail-card",shadow:"hover"},{header:c(()=>[l("div",rs,[u[0]||(u[0]=l("span",null,"è®¾å¤‡è¯¦æƒ…",-1)),a(d,{type:o(e.device.status),size:"small"},{default:c(()=>[M(S(s(e.device.status)),1)]),_:1},8,["type"])])]),default:c(()=>[l("div",is,[l("div",cs,[u[5]||(u[5]=l("h4",null,"åŸºæœ¬ä¿¡æ¯",-1)),l("div",us,[l("div",ds,[u[1]||(u[1]=l("span",{class:"label"},"è®¾å¤‡ID:",-1)),l("span",fs,S(e.device.deviceId),1)]),l("div",ps,[u[2]||(u[2]=l("span",{class:"label"},"è®¾å¤‡ç±»å‹:",-1)),l("span",ms,S(e.device.deviceType),1)]),l("div",vs,[u[3]||(u[3]=l("span",{class:"label"},"ç‰ˆæœ¬:",-1)),l("span",hs,S(e.device.version),1)]),l("div",gs,[u[4]||(u[4]=l("span",{class:"label"},"ç½‘ç»œå¥åº·çŠ¶æ€:",-1)),l("span",ys,[a(w,{percentage:e.device.healthScore||0,color:i(e.device.healthScore),"stroke-width":8,"show-text":!0},null,8,["percentage","color"])])])])]),e.device.user?(L(),H("div",_s,[u[9]||(u[9]=l("h4",null,"ç”¨æˆ·ä¿¡æ¯",-1)),l("div",ws,[l("div",bs,[u[6]||(u[6]=l("span",{class:"label"},"ç”¨æˆ·å:",-1)),l("span",Ss,S(e.device.user.username),1)]),l("div",Es,[u[7]||(u[7]=l("span",{class:"label"},"é‚®ç®±:",-1)),l("span",Is,S(e.device.user.email),1)]),l("div",Cs,[u[8]||(u[8]=l("span",{class:"label"},"æ‰‹æœº:",-1)),l("span",Ts,S(e.device.user.phone),1)])])])):ae("",!0),e.device.currentLocation?(L(),H("div",ks,[u[14]||(u[14]=l("h4",null,"ä½ç½®ä¿¡æ¯",-1)),l("div",As,[l("div",xs,[u[10]||(u[10]=l("span",{class:"label"},"ç»åº¦:",-1)),l("span",Ds,S(e.device.currentLocation.lng?.toFixed(6)),1)]),l("div",Os,[u[11]||(u[11]=l("span",{class:"label"},"çº¬åº¦:",-1)),l("span",Ms,S(e.device.currentLocation.lat?.toFixed(6)),1)]),l("div",$s,[u[12]||(u[12]=l("span",{class:"label"},"æµ·æ‹”:",-1)),l("span",Rs,S(e.device.currentLocation.altitude?.toFixed(2))+" m",1)]),l("div",Ls,[u[13]||(u[13]=l("span",{class:"label"},"ç²¾åº¦:",-1)),l("span",Ps,S(e.device.currentLocation.hdop?.toFixed(2)),1)])])])):ae("",!0),n.value&&e.device.currentLocation?(L(),H("div",Fs,[u[19]||(u[19]=l("h4",null,"å®æ—¶ä¿¡æ¯",-1)),l("div",Ns,[l("div",Us,[u[15]||(u[15]=l("span",{class:"label"},"é€Ÿåº¦:",-1)),l("span",zs,S(e.device.currentLocation.speed?.toFixed(1))+" km/h",1)]),l("div",Bs,[u[16]||(u[16]=l("span",{class:"label"},"æ–¹å‘:",-1)),l("span",Hs,S(e.device.currentLocation.direction?.toFixed(1))+"Â°",1)]),l("div",Vs,[u[17]||(u[17]=l("span",{class:"label"},"å«æ˜Ÿæ•°:",-1)),l("span",Ws,S(e.device.currentLocation.satellites),1)]),l("div",js,[u[18]||(u[18]=l("span",{class:"label"},"æœ€åæ›´æ–°:",-1)),l("span",qs,S(r(e.device.lastSeen)),1)])])])):ae("",!0),n.value?ae("",!0):(L(),H("div",Gs,[a(T,{title:"è®¾å¤‡ç¦»çº¿",description:"è®¾å¤‡å½“å‰å¤„äºç¦»çº¿çŠ¶æ€ï¼Œå®æ—¶ä¿¡æ¯ä¸å¯ç”¨",type:"warning",closable:!1,"show-icon":""})])),e.device.statistics?(L(),H("div",Ks,[u[24]||(u[24]=l("h4",null,"ç»Ÿè®¡ä¿¡æ¯",-1)),l("div",Js,[l("div",Ys,[u[20]||(u[20]=l("span",{class:"label"},"ç–²åŠ³äº‹ä»¶:",-1)),l("span",Xs,S(e.device.statistics.fatigueEvents||0),1)]),l("div",Qs,[u[21]||(u[21]=l("span",{class:"label"},"åˆ†å¿ƒäº‹ä»¶:",-1)),l("span",Zs,S(e.device.statistics.distractionEvents||0),1)]),l("div",ea,[u[22]||(u[22]=l("span",{class:"label"},"æ€»é©¾é©¶æ—¶é—´:",-1)),l("span",ta,S(p(e.device.statistics.totalDrivingTime)),1)]),l("div",na,[u[23]||(u[23]=l("span",{class:"label"},"æ€»è¡Œé©¶è·ç¦»:",-1)),l("span",oa,S(e.device.statistics.totalDistance?.toFixed(2)||0)+" km",1)])])])):ae("",!0)])]),_:1})}}},aa=Ce(sa,[["__scopeId","data-v-797f3a06"]]);function Dn(e,t){return function(){return e.apply(t,arguments)}}const{toString:la}=Object.prototype,{getPrototypeOf:Ht}=Object,{iterator:gt,toStringTag:On}=Symbol,yt=(e=>t=>{const n=la.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),ke=e=>(e=e.toLowerCase(),t=>yt(t)===e),_t=e=>t=>typeof t===e,{isArray:je}=Array,Qe=_t("undefined");function Ze(e){return e!==null&&!Qe(e)&&e.constructor!==null&&!Qe(e.constructor)&&Ee(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Mn=ke("ArrayBuffer");function ra(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Mn(e.buffer),t}const ia=_t("string"),Ee=_t("function"),$n=_t("number"),et=e=>e!==null&&typeof e=="object",ca=e=>e===!0||e===!1,ct=e=>{if(yt(e)!=="object")return!1;const t=Ht(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(On in e)&&!(gt in e)},ua=e=>{if(!et(e)||Ze(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},da=ke("Date"),fa=ke("File"),pa=ke("Blob"),ma=ke("FileList"),va=e=>et(e)&&Ee(e.pipe),ha=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Ee(e.append)&&((t=yt(e))==="formdata"||t==="object"&&Ee(e.toString)&&e.toString()==="[object FormData]"))},ga=ke("URLSearchParams"),[ya,_a,wa,ba]=["ReadableStream","Request","Response","Headers"].map(ke),Sa=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function tt(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let o,s;if(typeof e!="object"&&(e=[e]),je(e))for(o=0,s=e.length;o<s;o++)t.call(null,e[o],o,e);else{if(Ze(e))return;const i=n?Object.getOwnPropertyNames(e):Object.keys(e),r=i.length;let p;for(o=0;o<r;o++)p=i[o],t.call(null,e[p],p,e)}}function Rn(e,t){if(Ze(e))return null;t=t.toLowerCase();const n=Object.keys(e);let o=n.length,s;for(;o-- >0;)if(s=n[o],t===s.toLowerCase())return s;return null}const $e=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Ln=e=>!Qe(e)&&e!==$e;function Mt(){const{caseless:e}=Ln(this)&&this||{},t={},n=(o,s)=>{const i=e&&Rn(t,s)||s;ct(t[i])&&ct(o)?t[i]=Mt(t[i],o):ct(o)?t[i]=Mt({},o):je(o)?t[i]=o.slice():t[i]=o};for(let o=0,s=arguments.length;o<s;o++)arguments[o]&&tt(arguments[o],n);return t}const Ea=(e,t,n,{allOwnKeys:o}={})=>(tt(t,(s,i)=>{n&&Ee(s)?e[i]=Dn(s,n):e[i]=s},{allOwnKeys:o}),e),Ia=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Ca=(e,t,n,o)=>{e.prototype=Object.create(t.prototype,o),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},Ta=(e,t,n,o)=>{let s,i,r;const p={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),i=s.length;i-- >0;)r=s[i],(!o||o(r,e,t))&&!p[r]&&(t[r]=e[r],p[r]=!0);e=n!==!1&&Ht(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},ka=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const o=e.indexOf(t,n);return o!==-1&&o===n},Aa=e=>{if(!e)return null;if(je(e))return e;let t=e.length;if(!$n(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},xa=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Ht(Uint8Array)),Da=(e,t)=>{const o=(e&&e[gt]).call(e);let s;for(;(s=o.next())&&!s.done;){const i=s.value;t.call(e,i[0],i[1])}},Oa=(e,t)=>{let n;const o=[];for(;(n=e.exec(t))!==null;)o.push(n);return o},Ma=ke("HTMLFormElement"),$a=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,o,s){return o.toUpperCase()+s}),tn=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Ra=ke("RegExp"),Pn=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),o={};tt(n,(s,i)=>{let r;(r=t(s,i,e))!==!1&&(o[i]=r||s)}),Object.defineProperties(e,o)},La=e=>{Pn(e,(t,n)=>{if(Ee(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const o=e[n];if(Ee(o)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Pa=(e,t)=>{const n={},o=s=>{s.forEach(i=>{n[i]=!0})};return je(e)?o(e):o(String(e).split(t)),n},Fa=()=>{},Na=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Ua(e){return!!(e&&Ee(e.append)&&e[On]==="FormData"&&e[gt])}const za=e=>{const t=new Array(10),n=(o,s)=>{if(et(o)){if(t.indexOf(o)>=0)return;if(Ze(o))return o;if(!("toJSON"in o)){t[s]=o;const i=je(o)?[]:{};return tt(o,(r,p)=>{const _=n(r,s+1);!Qe(_)&&(i[p]=_)}),t[s]=void 0,i}}return o};return n(e,0)},Ba=ke("AsyncFunction"),Ha=e=>e&&(et(e)||Ee(e))&&Ee(e.then)&&Ee(e.catch),Fn=((e,t)=>e?setImmediate:t?((n,o)=>($e.addEventListener("message",({source:s,data:i})=>{s===$e&&i===n&&o.length&&o.shift()()},!1),s=>{o.push(s),$e.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Ee($e.postMessage)),Va=typeof queueMicrotask<"u"?queueMicrotask.bind($e):typeof process<"u"&&process.nextTick||Fn,Wa=e=>e!=null&&Ee(e[gt]),g={isArray:je,isArrayBuffer:Mn,isBuffer:Ze,isFormData:ha,isArrayBufferView:ra,isString:ia,isNumber:$n,isBoolean:ca,isObject:et,isPlainObject:ct,isEmptyObject:ua,isReadableStream:ya,isRequest:_a,isResponse:wa,isHeaders:ba,isUndefined:Qe,isDate:da,isFile:fa,isBlob:pa,isRegExp:Ra,isFunction:Ee,isStream:va,isURLSearchParams:ga,isTypedArray:xa,isFileList:ma,forEach:tt,merge:Mt,extend:Ea,trim:Sa,stripBOM:Ia,inherits:Ca,toFlatObject:Ta,kindOf:yt,kindOfTest:ke,endsWith:ka,toArray:Aa,forEachEntry:Da,matchAll:Oa,isHTMLForm:Ma,hasOwnProperty:tn,hasOwnProp:tn,reduceDescriptors:Pn,freezeMethods:La,toObjectSet:Pa,toCamelCase:$a,noop:Fa,toFiniteNumber:Na,findKey:Rn,global:$e,isContextDefined:Ln,isSpecCompliantForm:Ua,toJSONObject:za,isAsyncFn:Ba,isThenable:Ha,setImmediate:Fn,asap:Va,isIterable:Wa};function q(e,t,n,o,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),o&&(this.request=o),s&&(this.response=s,this.status=s.status?s.status:null)}g.inherits(q,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:g.toJSONObject(this.config),code:this.code,status:this.status}}});const Nn=q.prototype,Un={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Un[e]={value:e}});Object.defineProperties(q,Un);Object.defineProperty(Nn,"isAxiosError",{value:!0});q.from=(e,t,n,o,s,i)=>{const r=Object.create(Nn);return g.toFlatObject(e,r,function(_){return _!==Error.prototype},p=>p!=="isAxiosError"),q.call(r,e.message,t,n,o,s),r.cause=e,r.name=e.name,i&&Object.assign(r,i),r};const ja=null;function $t(e){return g.isPlainObject(e)||g.isArray(e)}function zn(e){return g.endsWith(e,"[]")?e.slice(0,-2):e}function nn(e,t,n){return e?e.concat(t).map(function(s,i){return s=zn(s),!n&&i?"["+s+"]":s}).join(n?".":""):t}function qa(e){return g.isArray(e)&&!e.some($t)}const Ga=g.toFlatObject(g,{},null,function(t){return/^is[A-Z]/.test(t)});function wt(e,t,n){if(!g.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=g.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,y){return!g.isUndefined(y[m])});const o=n.metaTokens,s=n.visitor||d,i=n.dots,r=n.indexes,_=(n.Blob||typeof Blob<"u"&&Blob)&&g.isSpecCompliantForm(t);if(!g.isFunction(s))throw new TypeError("visitor must be a function");function u(f){if(f===null)return"";if(g.isDate(f))return f.toISOString();if(g.isBoolean(f))return f.toString();if(!_&&g.isBlob(f))throw new q("Blob is not supported. Use a Buffer instead.");return g.isArrayBuffer(f)||g.isTypedArray(f)?_&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function d(f,m,y){let x=f;if(f&&!y&&typeof f=="object"){if(g.endsWith(m,"{}"))m=o?m:m.slice(0,-2),f=JSON.stringify(f);else if(g.isArray(f)&&qa(f)||(g.isFileList(f)||g.endsWith(m,"[]"))&&(x=g.toArray(f)))return m=zn(m),x.forEach(function(N,U){!(g.isUndefined(N)||N===null)&&t.append(r===!0?nn([m],U,i):r===null?m:m+"[]",u(N))}),!1}return $t(f)?!0:(t.append(nn(y,m,i),u(f)),!1)}const w=[],T=Object.assign(Ga,{defaultVisitor:d,convertValue:u,isVisitable:$t});function b(f,m){if(!g.isUndefined(f)){if(w.indexOf(f)!==-1)throw Error("Circular reference detected in "+m.join("."));w.push(f),g.forEach(f,function(x,O){(!(g.isUndefined(x)||x===null)&&s.call(t,x,g.isString(O)?O.trim():O,m,T))===!0&&b(x,m?m.concat(O):[O])}),w.pop()}}if(!g.isObject(e))throw new TypeError("data must be an object");return b(e),t}function on(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(o){return t[o]})}function Vt(e,t){this._pairs=[],e&&wt(e,this,t)}const Bn=Vt.prototype;Bn.append=function(t,n){this._pairs.push([t,n])};Bn.toString=function(t){const n=t?function(o){return t.call(this,o,on)}:on;return this._pairs.map(function(s){return n(s[0])+"="+n(s[1])},"").join("&")};function Ka(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Hn(e,t,n){if(!t)return e;const o=n&&n.encode||Ka;g.isFunction(n)&&(n={serialize:n});const s=n&&n.serialize;let i;if(s?i=s(t,n):i=g.isURLSearchParams(t)?t.toString():new Vt(t,n).toString(o),i){const r=e.indexOf("#");r!==-1&&(e=e.slice(0,r)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class sn{constructor(){this.handlers=[]}use(t,n,o){return this.handlers.push({fulfilled:t,rejected:n,synchronous:o?o.synchronous:!1,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){g.forEach(this.handlers,function(o){o!==null&&t(o)})}}const Vn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ja=typeof URLSearchParams<"u"?URLSearchParams:Vt,Ya=typeof FormData<"u"?FormData:null,Xa=typeof Blob<"u"?Blob:null,Qa={isBrowser:!0,classes:{URLSearchParams:Ja,FormData:Ya,Blob:Xa},protocols:["http","https","file","blob","url","data"]},Wt=typeof window<"u"&&typeof document<"u",Rt=typeof navigator=="object"&&navigator||void 0,Za=Wt&&(!Rt||["ReactNative","NativeScript","NS"].indexOf(Rt.product)<0),el=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",tl=Wt&&window.location.href||"http://localhost",nl=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Wt,hasStandardBrowserEnv:Za,hasStandardBrowserWebWorkerEnv:el,navigator:Rt,origin:tl},Symbol.toStringTag,{value:"Module"})),ge={...nl,...Qa};function ol(e,t){return wt(e,new ge.classes.URLSearchParams,{visitor:function(n,o,s,i){return ge.isNode&&g.isBuffer(n)?(this.append(o,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function sl(e){return g.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function al(e){const t={},n=Object.keys(e);let o;const s=n.length;let i;for(o=0;o<s;o++)i=n[o],t[i]=e[i];return t}function Wn(e){function t(n,o,s,i){let r=n[i++];if(r==="__proto__")return!0;const p=Number.isFinite(+r),_=i>=n.length;return r=!r&&g.isArray(s)?s.length:r,_?(g.hasOwnProp(s,r)?s[r]=[s[r],o]:s[r]=o,!p):((!s[r]||!g.isObject(s[r]))&&(s[r]=[]),t(n,o,s[r],i)&&g.isArray(s[r])&&(s[r]=al(s[r])),!p)}if(g.isFormData(e)&&g.isFunction(e.entries)){const n={};return g.forEachEntry(e,(o,s)=>{t(sl(o),s,n,0)}),n}return null}function ll(e,t,n){if(g.isString(e))try{return(t||JSON.parse)(e),g.trim(e)}catch(o){if(o.name!=="SyntaxError")throw o}return(n||JSON.stringify)(e)}const nt={transitional:Vn,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const o=n.getContentType()||"",s=o.indexOf("application/json")>-1,i=g.isObject(t);if(i&&g.isHTMLForm(t)&&(t=new FormData(t)),g.isFormData(t))return s?JSON.stringify(Wn(t)):t;if(g.isArrayBuffer(t)||g.isBuffer(t)||g.isStream(t)||g.isFile(t)||g.isBlob(t)||g.isReadableStream(t))return t;if(g.isArrayBufferView(t))return t.buffer;if(g.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let p;if(i){if(o.indexOf("application/x-www-form-urlencoded")>-1)return ol(t,this.formSerializer).toString();if((p=g.isFileList(t))||o.indexOf("multipart/form-data")>-1){const _=this.env&&this.env.FormData;return wt(p?{"files[]":t}:t,_&&new _,this.formSerializer)}}return i||s?(n.setContentType("application/json",!1),ll(t)):t}],transformResponse:[function(t){const n=this.transitional||nt.transitional,o=n&&n.forcedJSONParsing,s=this.responseType==="json";if(g.isResponse(t)||g.isReadableStream(t))return t;if(t&&g.isString(t)&&(o&&!this.responseType||s)){const r=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(t)}catch(p){if(r)throw p.name==="SyntaxError"?q.from(p,q.ERR_BAD_RESPONSE,this,null,this.response):p}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ge.classes.FormData,Blob:ge.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};g.forEach(["delete","get","head","post","put","patch"],e=>{nt.headers[e]={}});const rl=g.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),il=e=>{const t={};let n,o,s;return e&&e.split(`
`).forEach(function(r){s=r.indexOf(":"),n=r.substring(0,s).trim().toLowerCase(),o=r.substring(s+1).trim(),!(!n||t[n]&&rl[n])&&(n==="set-cookie"?t[n]?t[n].push(o):t[n]=[o]:t[n]=t[n]?t[n]+", "+o:o)}),t},an=Symbol("internals");function Ye(e){return e&&String(e).trim().toLowerCase()}function ut(e){return e===!1||e==null?e:g.isArray(e)?e.map(ut):String(e)}function cl(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let o;for(;o=n.exec(e);)t[o[1]]=o[2];return t}const ul=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Ct(e,t,n,o,s){if(g.isFunction(o))return o.call(this,t,n);if(s&&(t=n),!!g.isString(t)){if(g.isString(o))return t.indexOf(o)!==-1;if(g.isRegExp(o))return o.test(t)}}function dl(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,o)=>n.toUpperCase()+o)}function fl(e,t){const n=g.toCamelCase(" "+t);["get","set","has"].forEach(o=>{Object.defineProperty(e,o+n,{value:function(s,i,r){return this[o].call(this,t,s,i,r)},configurable:!0})})}let Ie=class{constructor(t){t&&this.set(t)}set(t,n,o){const s=this;function i(p,_,u){const d=Ye(_);if(!d)throw new Error("header name must be a non-empty string");const w=g.findKey(s,d);(!w||s[w]===void 0||u===!0||u===void 0&&s[w]!==!1)&&(s[w||_]=ut(p))}const r=(p,_)=>g.forEach(p,(u,d)=>i(u,d,_));if(g.isPlainObject(t)||t instanceof this.constructor)r(t,n);else if(g.isString(t)&&(t=t.trim())&&!ul(t))r(il(t),n);else if(g.isObject(t)&&g.isIterable(t)){let p={},_,u;for(const d of t){if(!g.isArray(d))throw TypeError("Object iterator must return a key-value pair");p[u=d[0]]=(_=p[u])?g.isArray(_)?[..._,d[1]]:[_,d[1]]:d[1]}r(p,n)}else t!=null&&i(n,t,o);return this}get(t,n){if(t=Ye(t),t){const o=g.findKey(this,t);if(o){const s=this[o];if(!n)return s;if(n===!0)return cl(s);if(g.isFunction(n))return n.call(this,s,o);if(g.isRegExp(n))return n.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Ye(t),t){const o=g.findKey(this,t);return!!(o&&this[o]!==void 0&&(!n||Ct(this,this[o],o,n)))}return!1}delete(t,n){const o=this;let s=!1;function i(r){if(r=Ye(r),r){const p=g.findKey(o,r);p&&(!n||Ct(o,o[p],p,n))&&(delete o[p],s=!0)}}return g.isArray(t)?t.forEach(i):i(t),s}clear(t){const n=Object.keys(this);let o=n.length,s=!1;for(;o--;){const i=n[o];(!t||Ct(this,this[i],i,t,!0))&&(delete this[i],s=!0)}return s}normalize(t){const n=this,o={};return g.forEach(this,(s,i)=>{const r=g.findKey(o,i);if(r){n[r]=ut(s),delete n[i];return}const p=t?dl(i):String(i).trim();p!==i&&delete n[i],n[p]=ut(s),o[p]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return g.forEach(this,(o,s)=>{o!=null&&o!==!1&&(n[s]=t&&g.isArray(o)?o.join(", "):o)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const o=new this(t);return n.forEach(s=>o.set(s)),o}static accessor(t){const o=(this[an]=this[an]={accessors:{}}).accessors,s=this.prototype;function i(r){const p=Ye(r);o[p]||(fl(s,r),o[p]=!0)}return g.isArray(t)?t.forEach(i):i(t),this}};Ie.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);g.reduceDescriptors(Ie.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(o){this[n]=o}}});g.freezeMethods(Ie);function Tt(e,t){const n=this||nt,o=t||n,s=Ie.from(o.headers);let i=o.data;return g.forEach(e,function(p){i=p.call(n,i,s.normalize(),t?t.status:void 0)}),s.normalize(),i}function jn(e){return!!(e&&e.__CANCEL__)}function qe(e,t,n){q.call(this,e??"canceled",q.ERR_CANCELED,t,n),this.name="CanceledError"}g.inherits(qe,q,{__CANCEL__:!0});function qn(e,t,n){const o=n.config.validateStatus;!n.status||!o||o(n.status)?e(n):t(new q("Request failed with status code "+n.status,[q.ERR_BAD_REQUEST,q.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function pl(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function ml(e,t){e=e||10;const n=new Array(e),o=new Array(e);let s=0,i=0,r;return t=t!==void 0?t:1e3,function(_){const u=Date.now(),d=o[i];r||(r=u),n[s]=_,o[s]=u;let w=i,T=0;for(;w!==s;)T+=n[w++],w=w%e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),u-r<t)return;const b=d&&u-d;return b?Math.round(T*1e3/b):void 0}}function vl(e,t){let n=0,o=1e3/t,s,i;const r=(u,d=Date.now())=>{n=d,s=null,i&&(clearTimeout(i),i=null),e(...u)};return[(...u)=>{const d=Date.now(),w=d-n;w>=o?r(u,d):(s=u,i||(i=setTimeout(()=>{i=null,r(s)},o-w)))},()=>s&&r(s)]}const pt=(e,t,n=3)=>{let o=0;const s=ml(50,250);return vl(i=>{const r=i.loaded,p=i.lengthComputable?i.total:void 0,_=r-o,u=s(_),d=r<=p;o=r;const w={loaded:r,total:p,progress:p?r/p:void 0,bytes:_,rate:u||void 0,estimated:u&&p&&d?(p-r)/u:void 0,event:i,lengthComputable:p!=null,[t?"download":"upload"]:!0};e(w)},n)},ln=(e,t)=>{const n=e!=null;return[o=>t[0]({lengthComputable:n,total:e,loaded:o}),t[1]]},rn=e=>(...t)=>g.asap(()=>e(...t)),hl=ge.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,ge.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(ge.origin),ge.navigator&&/(msie|trident)/i.test(ge.navigator.userAgent)):()=>!0,gl=ge.hasStandardBrowserEnv?{write(e,t,n,o,s,i){const r=[e+"="+encodeURIComponent(t)];g.isNumber(n)&&r.push("expires="+new Date(n).toGMTString()),g.isString(o)&&r.push("path="+o),g.isString(s)&&r.push("domain="+s),i===!0&&r.push("secure"),document.cookie=r.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function yl(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function _l(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Gn(e,t,n){let o=!yl(t);return e&&(o||n==!1)?_l(e,t):t}const cn=e=>e instanceof Ie?{...e}:e;function Ne(e,t){t=t||{};const n={};function o(u,d,w,T){return g.isPlainObject(u)&&g.isPlainObject(d)?g.merge.call({caseless:T},u,d):g.isPlainObject(d)?g.merge({},d):g.isArray(d)?d.slice():d}function s(u,d,w,T){if(g.isUndefined(d)){if(!g.isUndefined(u))return o(void 0,u,w,T)}else return o(u,d,w,T)}function i(u,d){if(!g.isUndefined(d))return o(void 0,d)}function r(u,d){if(g.isUndefined(d)){if(!g.isUndefined(u))return o(void 0,u)}else return o(void 0,d)}function p(u,d,w){if(w in t)return o(u,d);if(w in e)return o(void 0,u)}const _={url:i,method:i,data:i,baseURL:r,transformRequest:r,transformResponse:r,paramsSerializer:r,timeout:r,timeoutMessage:r,withCredentials:r,withXSRFToken:r,adapter:r,responseType:r,xsrfCookieName:r,xsrfHeaderName:r,onUploadProgress:r,onDownloadProgress:r,decompress:r,maxContentLength:r,maxBodyLength:r,beforeRedirect:r,transport:r,httpAgent:r,httpsAgent:r,cancelToken:r,socketPath:r,responseEncoding:r,validateStatus:p,headers:(u,d,w)=>s(cn(u),cn(d),w,!0)};return g.forEach(Object.keys({...e,...t}),function(d){const w=_[d]||s,T=w(e[d],t[d],d);g.isUndefined(T)&&w!==p||(n[d]=T)}),n}const Kn=e=>{const t=Ne({},e);let{data:n,withXSRFToken:o,xsrfHeaderName:s,xsrfCookieName:i,headers:r,auth:p}=t;t.headers=r=Ie.from(r),t.url=Hn(Gn(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),p&&r.set("Authorization","Basic "+btoa((p.username||"")+":"+(p.password?unescape(encodeURIComponent(p.password)):"")));let _;if(g.isFormData(n)){if(ge.hasStandardBrowserEnv||ge.hasStandardBrowserWebWorkerEnv)r.setContentType(void 0);else if((_=r.getContentType())!==!1){const[u,...d]=_?_.split(";").map(w=>w.trim()).filter(Boolean):[];r.setContentType([u||"multipart/form-data",...d].join("; "))}}if(ge.hasStandardBrowserEnv&&(o&&g.isFunction(o)&&(o=o(t)),o||o!==!1&&hl(t.url))){const u=s&&i&&gl.read(i);u&&r.set(s,u)}return t},wl=typeof XMLHttpRequest<"u",bl=wl&&function(e){return new Promise(function(n,o){const s=Kn(e);let i=s.data;const r=Ie.from(s.headers).normalize();let{responseType:p,onUploadProgress:_,onDownloadProgress:u}=s,d,w,T,b,f;function m(){b&&b(),f&&f(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let y=new XMLHttpRequest;y.open(s.method.toUpperCase(),s.url,!0),y.timeout=s.timeout;function x(){if(!y)return;const N=Ie.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),K={data:!p||p==="text"||p==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:N,config:e,request:y};qn(function(Z){n(Z),m()},function(Z){o(Z),m()},K),y=null}"onloadend"in y?y.onloadend=x:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(x)},y.onabort=function(){y&&(o(new q("Request aborted",q.ECONNABORTED,e,y)),y=null)},y.onerror=function(){o(new q("Network Error",q.ERR_NETWORK,e,y)),y=null},y.ontimeout=function(){let U=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const K=s.transitional||Vn;s.timeoutErrorMessage&&(U=s.timeoutErrorMessage),o(new q(U,K.clarifyTimeoutError?q.ETIMEDOUT:q.ECONNABORTED,e,y)),y=null},i===void 0&&r.setContentType(null),"setRequestHeader"in y&&g.forEach(r.toJSON(),function(U,K){y.setRequestHeader(K,U)}),g.isUndefined(s.withCredentials)||(y.withCredentials=!!s.withCredentials),p&&p!=="json"&&(y.responseType=s.responseType),u&&([T,f]=pt(u,!0),y.addEventListener("progress",T)),_&&y.upload&&([w,b]=pt(_),y.upload.addEventListener("progress",w),y.upload.addEventListener("loadend",b)),(s.cancelToken||s.signal)&&(d=N=>{y&&(o(!N||N.type?new qe(null,e,y):N),y.abort(),y=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const O=pl(s.url);if(O&&ge.protocols.indexOf(O)===-1){o(new q("Unsupported protocol "+O+":",q.ERR_BAD_REQUEST,e));return}y.send(i||null)})},Sl=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let o=new AbortController,s;const i=function(u){if(!s){s=!0,p();const d=u instanceof Error?u:this.reason;o.abort(d instanceof q?d:new qe(d instanceof Error?d.message:d))}};let r=t&&setTimeout(()=>{r=null,i(new q(`timeout ${t} of ms exceeded`,q.ETIMEDOUT))},t);const p=()=>{e&&(r&&clearTimeout(r),r=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),e=null)};e.forEach(u=>u.addEventListener("abort",i));const{signal:_}=o;return _.unsubscribe=()=>g.asap(p),_}},El=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let o=0,s;for(;o<n;)s=o+t,yield e.slice(o,s),o=s},Il=async function*(e,t){for await(const n of Cl(e))yield*El(n,t)},Cl=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:o}=await t.read();if(n)break;yield o}}finally{await t.cancel()}},un=(e,t,n,o)=>{const s=Il(e,t);let i=0,r,p=_=>{r||(r=!0,o&&o(_))};return new ReadableStream({async pull(_){try{const{done:u,value:d}=await s.next();if(u){p(),_.close();return}let w=d.byteLength;if(n){let T=i+=w;n(T)}_.enqueue(new Uint8Array(d))}catch(u){throw p(u),u}},cancel(_){return p(_),s.return()}},{highWaterMark:2})},bt=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Jn=bt&&typeof ReadableStream=="function",Tl=bt&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),Yn=(e,...t)=>{try{return!!e(...t)}catch{return!1}},kl=Jn&&Yn(()=>{let e=!1;const t=new Request(ge.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),dn=64*1024,Lt=Jn&&Yn(()=>g.isReadableStream(new Response("").body)),mt={stream:Lt&&(e=>e.body)};bt&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!mt[t]&&(mt[t]=g.isFunction(e[t])?n=>n[t]():(n,o)=>{throw new q(`Response type '${t}' is not supported`,q.ERR_NOT_SUPPORT,o)})})})(new Response);const Al=async e=>{if(e==null)return 0;if(g.isBlob(e))return e.size;if(g.isSpecCompliantForm(e))return(await new Request(ge.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(g.isArrayBufferView(e)||g.isArrayBuffer(e))return e.byteLength;if(g.isURLSearchParams(e)&&(e=e+""),g.isString(e))return(await Tl(e)).byteLength},xl=async(e,t)=>{const n=g.toFiniteNumber(e.getContentLength());return n??Al(t)},Dl=bt&&(async e=>{let{url:t,method:n,data:o,signal:s,cancelToken:i,timeout:r,onDownloadProgress:p,onUploadProgress:_,responseType:u,headers:d,withCredentials:w="same-origin",fetchOptions:T}=Kn(e);u=u?(u+"").toLowerCase():"text";let b=Sl([s,i&&i.toAbortSignal()],r),f;const m=b&&b.unsubscribe&&(()=>{b.unsubscribe()});let y;try{if(_&&kl&&n!=="get"&&n!=="head"&&(y=await xl(d,o))!==0){let K=new Request(t,{method:"POST",body:o,duplex:"half"}),J;if(g.isFormData(o)&&(J=K.headers.get("content-type"))&&d.setContentType(J),K.body){const[Z,oe]=ln(y,pt(rn(_)));o=un(K.body,dn,Z,oe)}}g.isString(w)||(w=w?"include":"omit");const x="credentials"in Request.prototype;f=new Request(t,{...T,signal:b,method:n.toUpperCase(),headers:d.normalize().toJSON(),body:o,duplex:"half",credentials:x?w:void 0});let O=await fetch(f,T);const N=Lt&&(u==="stream"||u==="response");if(Lt&&(p||N&&m)){const K={};["status","statusText","headers"].forEach(se=>{K[se]=O[se]});const J=g.toFiniteNumber(O.headers.get("content-length")),[Z,oe]=p&&ln(J,pt(rn(p),!0))||[];O=new Response(un(O.body,dn,Z,()=>{oe&&oe(),m&&m()}),K)}u=u||"text";let U=await mt[g.findKey(mt,u)||"text"](O,e);return!N&&m&&m(),await new Promise((K,J)=>{qn(K,J,{data:U,headers:Ie.from(O.headers),status:O.status,statusText:O.statusText,config:e,request:f})})}catch(x){throw m&&m(),x&&x.name==="TypeError"&&/Load failed|fetch/i.test(x.message)?Object.assign(new q("Network Error",q.ERR_NETWORK,e,f),{cause:x.cause||x}):q.from(x,x&&x.code,e,f)}}),Pt={http:ja,xhr:bl,fetch:Dl};g.forEach(Pt,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const fn=e=>`- ${e}`,Ol=e=>g.isFunction(e)||e===null||e===!1,Xn={getAdapter:e=>{e=g.isArray(e)?e:[e];const{length:t}=e;let n,o;const s={};for(let i=0;i<t;i++){n=e[i];let r;if(o=n,!Ol(n)&&(o=Pt[(r=String(n)).toLowerCase()],o===void 0))throw new q(`Unknown adapter '${r}'`);if(o)break;s[r||"#"+i]=o}if(!o){const i=Object.entries(s).map(([p,_])=>`adapter ${p} `+(_===!1?"is not supported by the environment":"is not available in the build"));let r=t?i.length>1?`since :
`+i.map(fn).join(`
`):" "+fn(i[0]):"as no adapter specified";throw new q("There is no suitable adapter to dispatch the request "+r,"ERR_NOT_SUPPORT")}return o},adapters:Pt};function kt(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new qe(null,e)}function pn(e){return kt(e),e.headers=Ie.from(e.headers),e.data=Tt.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Xn.getAdapter(e.adapter||nt.adapter)(e).then(function(o){return kt(e),o.data=Tt.call(e,e.transformResponse,o),o.headers=Ie.from(o.headers),o},function(o){return jn(o)||(kt(e),o&&o.response&&(o.response.data=Tt.call(e,e.transformResponse,o.response),o.response.headers=Ie.from(o.response.headers))),Promise.reject(o)})}const Qn="1.11.0",St={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{St[e]=function(o){return typeof o===e||"a"+(t<1?"n ":" ")+e}});const mn={};St.transitional=function(t,n,o){function s(i,r){return"[Axios v"+Qn+"] Transitional option '"+i+"'"+r+(o?". "+o:"")}return(i,r,p)=>{if(t===!1)throw new q(s(r," has been removed"+(n?" in "+n:"")),q.ERR_DEPRECATED);return n&&!mn[r]&&(mn[r]=!0,console.warn(s(r," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(i,r,p):!0}};St.spelling=function(t){return(n,o)=>(console.warn(`${o} is likely a misspelling of ${t}`),!0)};function Ml(e,t,n){if(typeof e!="object")throw new q("options must be an object",q.ERR_BAD_OPTION_VALUE);const o=Object.keys(e);let s=o.length;for(;s-- >0;){const i=o[s],r=t[i];if(r){const p=e[i],_=p===void 0||r(p,i,e);if(_!==!0)throw new q("option "+i+" must be "+_,q.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new q("Unknown option "+i,q.ERR_BAD_OPTION)}}const dt={assertOptions:Ml,validators:St},Ae=dt.validators;let Fe=class{constructor(t){this.defaults=t||{},this.interceptors={request:new sn,response:new sn}}async request(t,n){try{return await this._request(t,n)}catch(o){if(o instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{o.stack?i&&!String(o.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(o.stack+=`
`+i):o.stack=i}catch{}}throw o}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=Ne(this.defaults,n);const{transitional:o,paramsSerializer:s,headers:i}=n;o!==void 0&&dt.assertOptions(o,{silentJSONParsing:Ae.transitional(Ae.boolean),forcedJSONParsing:Ae.transitional(Ae.boolean),clarifyTimeoutError:Ae.transitional(Ae.boolean)},!1),s!=null&&(g.isFunction(s)?n.paramsSerializer={serialize:s}:dt.assertOptions(s,{encode:Ae.function,serialize:Ae.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),dt.assertOptions(n,{baseUrl:Ae.spelling("baseURL"),withXsrfToken:Ae.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let r=i&&g.merge(i.common,i[n.method]);i&&g.forEach(["delete","get","head","post","put","patch","common"],f=>{delete i[f]}),n.headers=Ie.concat(r,i);const p=[];let _=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(n)===!1||(_=_&&m.synchronous,p.unshift(m.fulfilled,m.rejected))});const u=[];this.interceptors.response.forEach(function(m){u.push(m.fulfilled,m.rejected)});let d,w=0,T;if(!_){const f=[pn.bind(this),void 0];for(f.unshift(...p),f.push(...u),T=f.length,d=Promise.resolve(n);w<T;)d=d.then(f[w++],f[w++]);return d}T=p.length;let b=n;for(w=0;w<T;){const f=p[w++],m=p[w++];try{b=f(b)}catch(y){m.call(this,y);break}}try{d=pn.call(this,b)}catch(f){return Promise.reject(f)}for(w=0,T=u.length;w<T;)d=d.then(u[w++],u[w++]);return d}getUri(t){t=Ne(this.defaults,t);const n=Gn(t.baseURL,t.url,t.allowAbsoluteUrls);return Hn(n,t.params,t.paramsSerializer)}};g.forEach(["delete","get","head","options"],function(t){Fe.prototype[t]=function(n,o){return this.request(Ne(o||{},{method:t,url:n,data:(o||{}).data}))}});g.forEach(["post","put","patch"],function(t){function n(o){return function(i,r,p){return this.request(Ne(p||{},{method:t,headers:o?{"Content-Type":"multipart/form-data"}:{},url:i,data:r}))}}Fe.prototype[t]=n(),Fe.prototype[t+"Form"]=n(!0)});let $l=class Zn{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const o=this;this.promise.then(s=>{if(!o._listeners)return;let i=o._listeners.length;for(;i-- >0;)o._listeners[i](s);o._listeners=null}),this.promise.then=s=>{let i;const r=new Promise(p=>{o.subscribe(p),i=p}).then(s);return r.cancel=function(){o.unsubscribe(i)},r},t(function(i,r,p){o.reason||(o.reason=new qe(i,r,p),n(o.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=o=>{t.abort(o)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new Zn(function(s){t=s}),cancel:t}}};function Rl(e){return function(n){return e.apply(null,n)}}function Ll(e){return g.isObject(e)&&e.isAxiosError===!0}const Ft={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ft).forEach(([e,t])=>{Ft[t]=e});function eo(e){const t=new Fe(e),n=Dn(Fe.prototype.request,t);return g.extend(n,Fe.prototype,t,{allOwnKeys:!0}),g.extend(n,t,null,{allOwnKeys:!0}),n.create=function(s){return eo(Ne(e,s))},n}const de=eo(nt);de.Axios=Fe;de.CanceledError=qe;de.CancelToken=$l;de.isCancel=jn;de.VERSION=Qn;de.toFormData=wt;de.AxiosError=q;de.Cancel=de.CanceledError;de.all=function(t){return Promise.all(t)};de.spread=Rl;de.isAxiosError=Ll;de.mergeConfig=Ne;de.AxiosHeaders=Ie;de.formToJSON=e=>Wn(g.isHTMLForm(e)?new FormData(e):e);de.getAdapter=Xn.getAdapter;de.HttpStatusCode=Ft;de.default=de;const{Axios:ic,AxiosError:cc,CanceledError:uc,isCancel:dc,CancelToken:fc,VERSION:pc,all:mc,Cancel:vc,isAxiosError:hc,spread:gc,toFormData:yc,AxiosHeaders:_c,HttpStatusCode:wc,formToJSON:bc,getAdapter:Sc,mergeConfig:Ec}=de,we=de.create({baseURL:"http://spacemit.topcoder.fun",timeout:1e4,headers:{"Content-Type":"application/json"}});we.interceptors.request.use(e=>{const t=localStorage.getItem("auth_token");return t&&(e.headers.Authorization=`Bearer ${t}`),console.log("APIè¯·æ±‚:",e.method?.toUpperCase(),e.url),e},e=>(console.error("è¯·æ±‚æ‹¦æˆªå™¨é”™è¯¯:",e),Promise.reject(e)));we.interceptors.response.use(e=>{const{data:t}=e;if(t.code!==void 0)if(t.code===200||t.code===0){console.log("=== APIå“åº”æ‹¦æˆªå™¨ ==="),console.log("åŸå§‹å“åº”:",t),console.log("data.data:",t.data),console.log("data.data.events:",t.data?.events),console.log("data.data.eventsé•¿åº¦:",t.data?.events?.length);const n=t.data||t;return console.log("æœ€ç»ˆè¿”å›æ•°æ®:",n),console.log("æœ€ç»ˆè¿”å›çš„events:",n.events),console.log("æœ€ç»ˆè¿”å›çš„eventsé•¿åº¦:",n.events?.length),n}else return ie.error(t.message||"è¯·æ±‚å¤±è´¥"),Promise.reject(new Error(t.message||"è¯·æ±‚å¤±è´¥"));return t},e=>{console.error("APIå“åº”é”™è¯¯:",e);let t="ç½‘ç»œé”™è¯¯";if(e.response){const{status:n,data:o}=e.response;switch(n){case 401:t="æœªæˆæƒï¼Œè¯·é‡æ–°ç™»å½•",localStorage.removeItem("auth_token");break;case 403:t="æ‹’ç»è®¿é—®";break;case 404:t="è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨";break;case 500:t="æœåŠ¡å™¨å†…éƒ¨é”™è¯¯";break;default:t=o?.message||`è¯·æ±‚å¤±è´¥ (${n})`}}else e.code==="ECONNABORTED"?t="è¯·æ±‚è¶…æ—¶":e.message&&(t=e.message);return ie.error(t),Promise.reject(e)});const Xe={getDevices(e={}){return console.log("=== APIè°ƒç”¨: è·å–è®¾å¤‡åˆ—è¡¨ ==="),console.log("è¯·æ±‚å‚æ•°:",e),we.get("/api/v1/platform/devices",{params:e})},getDeviceDetail(e){return we.get(`/api/v1/platform/devices/${e}`)},getDeviceTrack(e,t={}){return we.get(`/api/v1/platform/devices/${e}/track`,{params:t})},getRealtimeStream(){return we.get("/api/v1/platform/realtime/stream")},updateDevice(e,t){return console.log("=== APIè°ƒç”¨: æ›´æ–°è®¾å¤‡ä¿¡æ¯ ==="),console.log("è®¾å¤‡ID:",e),console.log("æ›´æ–°æ•°æ®:",t),we.put(`/api/v1/platform/devices/${e}`,t)}},jt=ht("device",()=>{const e=F([]),t=F(null),n=F([]),o=F(!1),s=F(null),i=Q(()=>e.value.filter(x=>x.status==="ONLINE")),r=Q(()=>e.value.filter(x=>x.status==="OFFLINE")),p=Q(()=>({total:e.value.length,online:i.value.length,offline:r.value.length})),_=async(x={})=>{o.value=!0,s.value=null,console.log("=== è®¾å¤‡Store: å¼€å§‹è·å–è®¾å¤‡åˆ—è¡¨ ==="),console.log("å‚æ•°:",x);try{const O=await Xe.getDevices(x);return console.log("è®¾å¤‡APIå“åº”:",O),console.log("å“åº”ä¸­çš„è®¾å¤‡æ•°ç»„:",O.devices),console.log("è®¾å¤‡æ•°ç»„é•¿åº¦:",O.devices?.length),O.devices&&O.devices.length>0?(e.value=O.devices,console.log("è®¾ç½®è®¾å¤‡åˆ—è¡¨:",e.value.length,"ä¸ªè®¾å¤‡"),console.log("æœ€ç»ˆè®¾å¤‡åˆ—è¡¨:",e.value),console.log("ç¬¬ä¸€ä¸ªè®¾å¤‡çš„ç”¨æˆ·å:",e.value[0]?.username),console.log("ç¬¬ä¸€ä¸ªè®¾å¤‡çš„è®¾å¤‡ID:",e.value[0]?.deviceId)):(console.log("APIè¿”å›çš„è®¾å¤‡æ•°ç»„ä¸ºç©ºï¼Œä½¿ç”¨ç©ºæ•°ç»„"),e.value=[]),e.value.length===0&&(console.log("âš ï¸ è­¦å‘Šï¼šä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼"),e.value=[{deviceId:"MUSE_PI_PRO_001",deviceType:"MUSE_PI_PRO",version:"1.0.0",status:"ONLINE",healthScore:85,lastSeen:new Date().toISOString(),username:"å¼ ä¸‰",phone:"13800138001",location:{lat:33.553733,lng:119.030953,speed:60,direction:45,altitude:10,hdop:1.2,satellites:8}},{deviceId:"MUSE_PI_PRO_002",deviceType:"MUSE_PI_PRO",version:"1.0.0",status:"ONLINE",healthScore:92,lastSeen:new Date(Date.now()-300*1e3).toISOString(),username:"æå››",phone:"13800138002",location:{lat:33.563733,lng:119.040953,speed:45,direction:90,altitude:15,hdop:.8,satellites:10}},{deviceId:"MUSE_PI_PRO_003",deviceType:"MUSE_PI_PRO",version:"1.0.0",status:"OFFLINE",healthScore:78,lastSeen:new Date(Date.now()-1800*1e3).toISOString(),username:"ç‹äº”",phone:"13800138003",location:{lat:33.543733,lng:119.020953,speed:0,direction:0,altitude:8,hdop:2.1,satellites:6}}]),O}catch(O){console.error("è·å–è®¾å¤‡åˆ—è¡¨å¤±è´¥:",O),s.value=O.message,console.log("APIè°ƒç”¨å¤±è´¥ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®"),e.value=[{deviceId:"MUSE_PI_PRO_001",deviceType:"MUSE_PI_PRO",version:"1.0.0",status:"ONLINE",healthScore:85,lastSeen:new Date().toISOString(),username:"å¼ ä¸‰",phone:"13800138001",location:{lat:33.553733,lng:119.030953,speed:60,direction:45,altitude:10,hdop:1.2,satellites:8}},{deviceId:"MUSE_PI_PRO_002",deviceType:"MUSE_PI_PRO",version:"1.0.0",status:"ONLINE",healthScore:92,lastSeen:new Date(Date.now()-300*1e3).toISOString(),username:"æå››",phone:"13800138002",location:{lat:33.563733,lng:119.040953,speed:45,direction:90,altitude:15,hdop:.8,satellites:10}},{deviceId:"MUSE_PI_PRO_003",deviceType:"MUSE_PI_PRO",version:"1.0.0",status:"OFFLINE",healthScore:78,lastSeen:new Date(Date.now()-1800*1e3).toISOString(),username:"ç‹äº”",phone:"13800138003",location:{lat:33.543733,lng:119.020953,speed:0,direction:0,altitude:8,hdop:2.1,satellites:6}}]}finally{o.value=!1}},u=async x=>{o.value=!0,s.value=null;try{const O=await Xe.getDeviceDetail(x);return t.value=O,O}catch(O){throw s.value=O.message,O}finally{o.value=!1}},d=async(x,O={})=>{try{return await Xe.getDeviceTrack(x,O)}catch(N){return s.value=N.message,{track:w(x,O)}}},w=(x,O)=>{const N=[],U=new Date(O.startTime||Date.now()-864e5),K=new Date(O.endTime||Date.now());let J=33.553733,Z=119.030953;const oe=Math.ceil((K-U)/(1e3*60*60));for(let se=0;se<oe;se++){const me=new Date(U.getTime()+se*60*60*1e3),ye=J+(Math.random()-.5)*.01,be=Z+(Math.random()-.5)*.01;N.push({timestamp:me.toISOString(),lat:ye,lng:be,speed:Math.random()*80+20,direction:Math.random()*360,altitude:Math.random()*20+5,hdop:Math.random()*2+.5,satellites:Math.floor(Math.random()*5)+6})}return N};return{devices:e,currentDevice:t,realtimeDevices:n,loading:o,error:s,onlineDevices:i,offlineDevices:r,deviceCount:p,fetchDevices:_,fetchDeviceDetail:u,fetchDeviceTrack:d,fetchRealtimeStream:async()=>{try{const x=await Xe.getRealtimeStream();return n.value=x.devices||[],x}catch(x){throw s.value=x.message,x}},updateDeviceStatus:(x,O)=>{const N=e.value.find(U=>U.deviceId===x);N&&(N.status=O,N.lastSeen=new Date().toISOString())},updateDeviceLocation:(x,O)=>{const N=e.value.find(U=>U.deviceId===x);N&&(N.location=O)},updateDevice:async(x,O)=>{o.value=!0,s.value=null,console.log("=== è®¾å¤‡Store: å¼€å§‹æ›´æ–°è®¾å¤‡ä¿¡æ¯ ==="),console.log("è®¾å¤‡ID:",x),console.log("æ›´æ–°æ•°æ®:",O);try{const N=await Xe.updateDevice(x,O);console.log("æ›´æ–°è®¾å¤‡APIå“åº”:",N);const U=e.value.find(K=>K.deviceId===x);return U&&Object.assign(U,O),N}catch(N){throw console.error("æ›´æ–°è®¾å¤‡å¤±è´¥:",N),s.value=N.message,N}finally{o.value=!1}},clearError:()=>{s.value=null}}}),Pl={getOverview(){return we.get("/api/v1/platform/overview")}},Fl=ht("overview",()=>{const e=F(null),t=F(!1),n=F(null);return{overview:e,loading:t,error:n,fetchOverview:async()=>{t.value=!0,n.value=null;try{const i=await Pl.getOverview();return e.value=i,i}catch(i){throw n.value=i.message,i}finally{t.value=!1}},clearError:()=>{n.value=null}}}),At={getEvents(e={}){return console.log("=== APIè°ƒç”¨: è·å–äº‹ä»¶åˆ—è¡¨ ==="),console.log("è¯·æ±‚å‚æ•°:",e),we.get("/api/v1/platform/events",{params:e})},getEventStatistics(e={}){return we.get("/api/v1/platform/events/statistics",{params:e})},getDrivingBehaviorAnalysis(e,t={}){return we.get("/api/v1/platform/analysis/driving-behavior",{params:{deviceId:e,...t}})}},vt=ht("event",()=>{const e=F([]),t=F(null),n=F(null),o=F(!1),s=F(null),i=Q(()=>({total:e.value.length,fatigue:e.value.filter(m=>m.eventType==="FATIGUE").length,distraction:e.value.filter(m=>m.eventType==="DISTRACTION").length,emergency:e.value.filter(m=>m.eventType==="EMERGENCY").length})),r=Q(()=>({low:e.value.filter(m=>m.severity==="LOW").length,medium:e.value.filter(m=>m.severity==="MEDIUM").length,high:e.value.filter(m=>m.severity==="HIGH").length,critical:e.value.filter(m=>m.severity==="CRITICAL").length})),p=async(m={})=>{o.value=!0,s.value=null,console.log("=== äº‹ä»¶Store: å¼€å§‹è·å–äº‹ä»¶åˆ—è¡¨ ==="),console.log("è¯·æ±‚å‚æ•°:",m);try{const y=await At.getEvents(m);return console.log("äº‹ä»¶APIå“åº”:",y),console.log("å“åº”ä¸­çš„äº‹ä»¶æ•°ç»„:",y.events),console.log("äº‹ä»¶æ•°ç»„é•¿åº¦:",y.events?.length),e.value=y.events||[],console.log("è®¾ç½®äº‹ä»¶åˆ—è¡¨:",e.value.length,"ä¸ªäº‹ä»¶"),console.log("æœ€ç»ˆäº‹ä»¶åˆ—è¡¨:",e.value),y}catch(y){console.error("è·å–äº‹ä»¶åˆ—è¡¨å¤±è´¥:",y),s.value=y.message,console.log("APIè°ƒç”¨å¤±è´¥ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®");const x=_(m);return e.value=x,{events:x}}finally{o.value=!1}},_=m=>{const y=[],x=m.deviceId||"MUSE_PI_PRO_001",O=["FATIGUE","DISTRACTION","EMERGENCY"],N=["LOW","MEDIUM","HIGH","CRITICAL"];for(let U=0;U<5;U++){const K=new Date(Date.now()-Math.random()*24*60*60*1e3),J=O[Math.floor(Math.random()*O.length)],Z=N[Math.floor(Math.random()*N.length)],oe=33.553733+(Math.random()-.5)*.01,se=119.030953+(Math.random()-.5)*.01;y.push({eventId:`EVENT_${Date.now()}_${U}`,deviceId:x,eventType:J,severity:Z,confidence:Math.random()*.4+.6,duration:Math.floor(Math.random()*30)+5,timestamp:K.toISOString(),location:{lat:oe,lng:se,altitude:Math.random()*20+5},behavior:u(J),context:d(J,Z)})}return y.sort((U,K)=>new Date(K.timestamp)-new Date(U.timestamp))},u=m=>{const x={FATIGUE:["é¢‘ç¹çœ¨çœ¼","å¤´éƒ¨ä¸‹å‚","æ‰“å“ˆæ¬ ","æ³¨æ„åŠ›ä¸é›†ä¸­"],DISTRACTION:["çœ‹æ‰‹æœº","è½¬å¤´è¯´è¯","åƒä¸œè¥¿","è°ƒæ•´è®¾å¤‡"],EMERGENCY:["æ€¥åˆ¹è½¦","æ€¥è½¬å¼¯","åç¦»è½¦é“","ç¢°æ’é¢„è­¦"]}[m]||["æœªçŸ¥è¡Œä¸º"];return x[Math.floor(Math.random()*x.length)]},d=(m,y)=>({FATIGUE:{LOW:"è½»å¾®ç–²åŠ³ï¼Œå»ºè®®é€‚å½“ä¼‘æ¯",MEDIUM:"ä¸­åº¦ç–²åŠ³ï¼Œå»ºè®®ç«‹å³ä¼‘æ¯",HIGH:"ä¸¥é‡ç–²åŠ³ï¼Œå­˜åœ¨å®‰å…¨éšæ‚£",CRITICAL:"æåº¦ç–²åŠ³ï¼Œç«‹å³åœè½¦ä¼‘æ¯"},DISTRACTION:{LOW:"è½»å¾®åˆ†å¿ƒï¼Œæ³¨æ„é©¾é©¶å®‰å…¨",MEDIUM:"ä¸­åº¦åˆ†å¿ƒï¼Œå½±å“é©¾é©¶å®‰å…¨",HIGH:"ä¸¥é‡åˆ†å¿ƒï¼Œå­˜åœ¨ç¢°æ’é£é™©",CRITICAL:"æåº¦åˆ†å¿ƒï¼Œç«‹å³åœæ­¢é©¾é©¶"},EMERGENCY:{LOW:"è½»å¾®ç´§æ€¥æƒ…å†µï¼Œæ³¨æ„è§‚å¯Ÿ",MEDIUM:"ä¸­åº¦ç´§æ€¥æƒ…å†µï¼Œè°¨æ…é©¾é©¶",HIGH:"ä¸¥é‡ç´§æ€¥æƒ…å†µï¼Œç«‹å³å¤„ç†",CRITICAL:"æåº¦ç´§æ€¥æƒ…å†µï¼Œç«‹å³åœè½¦"}})[m]?.[y]||"äº‹ä»¶è¯¦æƒ…";return{events:e,eventStatistics:t,drivingBehaviorAnalysis:n,loading:o,error:s,eventCount:i,severityCount:r,fetchEvents:p,fetchEventStatistics:async(m={})=>{try{const y=await At.getEventStatistics(m);return t.value=y,y}catch(y){throw s.value=y.message,y}},fetchDrivingBehaviorAnalysis:async(m,y={})=>{try{const x=await At.getDrivingBehaviorAnalysis(m,y);return n.value=x,x}catch(x){throw s.value=x.message,x}},addEvent:m=>{e.value.unshift(m)},clearError:()=>{s.value=null}}}),it={getRealtimeAlerts(){return we.get("/api/v1/platform/alerts/realtime")},getAlertHistory(e={}){return we.get("/api/v1/platform/alerts/history",{params:e})},acknowledgeAlert(e){return we.post(`/api/v1/platform/alerts/${e}/acknowledge`)},handleAlert(e,t){return we.post(`/api/v1/platform/alerts/${e}/handle`,t)}},Nl=ht("alert",()=>{const e=F([]),t=F([]),n=F(!1),o=F(null),s=Q(()=>({active:e.value.filter(b=>b.status==="ACTIVE").length,critical:e.value.filter(b=>b.severity==="CRITICAL").length,acknowledged:e.value.filter(b=>b.acknowledged).length,total:e.value.length})),i=Q(()=>e.value.filter(b=>!b.acknowledged));return{realtimeAlerts:e,alertHistory:t,loading:n,error:o,alertCount:s,unacknowledgedAlerts:i,fetchRealtimeAlerts:async()=>{n.value=!0,o.value=null;try{const b=await it.getRealtimeAlerts();return e.value=b.alerts||[],b}catch(b){throw o.value=b.message,b}finally{n.value=!1}},fetchAlertHistory:async(b={})=>{try{const f=await it.getAlertHistory(b);return t.value=f.alerts||[],f}catch(f){throw o.value=f.message,f}},acknowledgeAlert:async b=>{try{await it.acknowledgeAlert(b);const f=e.value.find(m=>m.alertId===b);f&&(f.acknowledged=!0)}catch(f){throw o.value=f.message,f}},handleAlert:async(b,f)=>{try{await it.handleAlert(b,f);const m=e.value.find(y=>y.alertId===b);m&&(m.status="HANDLED")}catch(m){throw o.value=m.message,m}},addAlert:b=>{e.value.unshift(b)},removeAlert:b=>{const f=e.value.findIndex(m=>m.alertId===b);f>-1&&e.value.splice(f,1)},clearError:()=>{o.value=null}}}),Ul={class:"dashboard"},zl={class:"admin-toggle"},Bl={class:"status-indicator"},Hl={class:"indicator-header"},Vl={class:"status-info"},Wl={class:"status-item"},jl={class:"status-item"},ql={class:"update-time"},Gl={class:"status-indicator"},Kl={class:"indicator-header"},Jl={class:"event-stream"},Yl={class:"stream-info"},Xl={class:"stream-item"},Ql={class:"event-count"},Zl={class:"stream-item"},er={class:"processing-speed"},tr={class:"indicator-header"},nr={key:0,class:"alert-badge"},or={class:"alert-info"},sr={class:"alert-item"},ar={class:"alert-item"},lr={class:"response-time"},rr={class:"card-header"},ir={class:"header-actions"},cr={class:"map-stats"},ur={class:"card-header"},dr={class:"alert-header-badge"},fr={key:0,class:"critical-indicator"},pr={class:"alert-list"},mr=["onClick"],vr={class:"alert-icon"},hr={class:"alert-content"},gr={class:"alert-title"},yr={class:"alert-meta"},_r={class:"alert-device"},wr={class:"alert-time"},br={class:"alert-severity"},Sr={key:0,class:"no-alerts"},Er={class:"card-header"},Ir={class:"header-actions"},Cr={key:0},Tr={key:1,class:"text-muted"},kr={class:"card-header"},Ar={class:"device-status-grid"},xr=["onClick"],Dr={class:"device-header"},Or={class:"device-info"},Mr={class:"device-id"},$r={class:"device-type"},Rr={class:"user-section"},Lr={class:"username"},Pr={class:"last-seen"},Fr={key:0,class:"realtime-section"},Nr={class:"realtime-grid"},Ur={key:0,class:"realtime-item"},zr={key:1,class:"realtime-item"},Br={class:"realtime-value"},Hr={key:2,class:"realtime-item"},Vr={class:"realtime-value"},Wr={key:3,class:"realtime-item"},jr={class:"realtime-value"},qr={key:0,class:"no-realtime-data"},Gr={key:1,class:"offline-section"},Kr={class:"health-section"},Jr=Object.assign({name:"DashboardView"},{__name:"Dashboard",setup(e){const t=Nt(),n=jt(),o=Fl(),s=vt(),i=F({}),r=F([]),p=F(""),_=F(""),u=F(!1),d=F(!1),w=F(!1),T=F([]),b=F([]),f=F(!1),m=F("åˆšåˆš"),y=F(0),x=F(150),O=F(0),N=F(2.5),U=F({apiKey:"",securityKey:"",version:"1.4.15"}),K=F(null),J=F(null),Z=Q(()=>{console.log("è®¡ç®—filteredDevicesï¼Œå½“å‰è®¾å¤‡æ•°é‡:",r.value.length),console.log("è®¾å¤‡åˆ—è¡¨:",r.value),console.log("æœç´¢å…³é”®è¯:",p.value),console.log("åœ°å›¾çŠ¶æ€ç­›é€‰:",_.value);let C=r.value;if(p.value){const h=p.value.toLowerCase();C=C.filter(W=>W.deviceId.toLowerCase().includes(h)||W.username&&W.username.toLowerCase().includes(h))}return _.value&&(C=C.filter(h=>h.status===_.value)),console.log("è¿‡æ»¤åè®¾å¤‡æ•°é‡:",C.length),C}),oe=Q(()=>f.value&&i.value.deviceStatus?.online>0?"healthy":f.value?"warning":"error"),se=Q(()=>n.devices.filter(C=>C.status==="ONLINE").length),me=Q(()=>n.devices.filter(C=>C.status==="OFFLINE"||C.status==="LOST").length),ye=async()=>{try{console.log("=== å¼€å§‹å¹¶è¡ŒåŠ è½½æ•°æ® ==="),w.value=!0,await Promise.all([be(),ve(),I(),v(),te()]),console.log("=== æ•°æ®åŠ è½½å®Œæˆ ===")}catch(C){console.error("åŠ è½½æ•°æ®å¤±è´¥:",C),ie.error("åŠ è½½æ•°æ®å¤±è´¥")}finally{w.value=!1}},be=async()=>{try{const C=await o.fetchOverview();i.value=C}catch(C){console.error("åŠ è½½æ¦‚è§ˆæ•°æ®å¤±è´¥:",C)}},ve=async()=>{try{console.log("=== Dashboard: å¼€å§‹åŠ è½½è®¾å¤‡åˆ—è¡¨ ==="),await n.fetchDevices(),console.log("=== Dashboard: è®¾å¤‡åˆ—è¡¨åŠ è½½å®Œæˆ ==="),console.log("å½“å‰è®¾å¤‡æ•°é‡:",n.devices.length),console.log("è®¾å¤‡åˆ—è¡¨:",n.devices),n.devices.length>0&&(console.log("ç¬¬ä¸€ä¸ªè®¾å¤‡è¯¦æƒ…:",n.devices[0]),console.log("ç¬¬ä¸€ä¸ªè®¾å¤‡ç”¨æˆ·å:",n.devices[0].username),console.log("ç¬¬ä¸€ä¸ªè®¾å¤‡ID:",n.devices[0].deviceId))}catch(C){console.error("åŠ è½½è®¾å¤‡åˆ—è¡¨å¤±è´¥:",C)}},I=async()=>{try{console.log("=== å¼€å§‹åŠ è½½å®æ—¶æ•°æ® ==="),await n.fetchDevices(),console.log("è®¾å¤‡åˆ—è¡¨:",n.devices);const C=await Promise.all(n.devices.map(async h=>{try{console.log(`è·å–è®¾å¤‡ ${h.deviceId} çš„è¯¦ç»†ä¿¡æ¯`);const W=await n.fetchDeviceDetail(h.deviceId);return console.log(`è®¾å¤‡ ${h.deviceId} è¯¦æƒ…:`,W),{...h,...W,currentLocation:W.currentLocation||null}}catch(W){return console.error(`è·å–è®¾å¤‡ ${h.deviceId} è¯¦æƒ…å¤±è´¥:`,W),{...h,currentLocation:null}}}));if(r.value=C,console.log("åˆå¹¶åçš„è®¾å¤‡æ•°æ®:",r.value),console.log("åˆå¹¶åè®¾å¤‡æ•°é‡:",r.value.length),r.value.length>0){const h=r.value[0];console.log("ç¬¬ä¸€ä¸ªè®¾å¤‡è¯¦æƒ…:",h),console.log("ç¬¬ä¸€ä¸ªè®¾å¤‡çš„currentLocation:",h.currentLocation)}}catch(C){console.error("åŠ è½½å®æ—¶æ•°æ®å¤±è´¥:",C),C.code==="ERR_NETWORK"||C.message==="Network Error"?console.log("ç½‘ç»œé”™è¯¯ï¼Œä½¿ç”¨è®¾å¤‡åˆ—è¡¨ä½œä¸ºå¤‡é€‰"):console.log("å…¶ä»–é”™è¯¯ï¼Œä½¿ç”¨è®¾å¤‡åˆ—è¡¨ä½œä¸ºå¤‡é€‰"),r.value=n.devices||[]}},v=async()=>{try{console.log("=== å¼€å§‹åŠ è½½äº‹ä»¶æ•°æ® ===");const C=vt(),h={startTime:new Date(Date.now()-10080*60*1e3).toISOString(),endTime:new Date().toISOString()};console.log("äº‹ä»¶æŸ¥è¯¢å‚æ•°:",h);const W=await C.fetchEvents(h);T.value=W.events||[],console.log("äº‹ä»¶æ•°æ®åŠ è½½å®Œæˆ:",T.value.length,"ä¸ªäº‹ä»¶"),console.log("äº‹ä»¶æ•°æ®è¯¦æƒ…:",T.value);const B={};T.value.forEach(G=>{B[G.eventType]=(B[G.eventType]||0)+1}),console.log("äº‹ä»¶ç±»å‹ç»Ÿè®¡:",B)}catch(C){console.error("åŠ è½½äº‹ä»¶æ•°æ®å¤±è´¥:",C),T.value=[],ie.warning("äº‹ä»¶æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥")}},te=async()=>{try{console.log("=== å¼€å§‹åŠ è½½æ´»è·ƒå‘Šè­¦ ===");const W=((await Nl().fetchRealtimeAlerts()).alerts||[]).sort((B,G)=>new Date(G.timestamp)-new Date(B.timestamp));b.value=W,console.log("æ´»è·ƒå‘Šè­¦åŠ è½½å®Œæˆ:",b.value.length,"ä¸ªå‘Šè­¦"),console.log("å‘Šè­¦æ•°æ®:",b.value)}catch(C){console.error("åŠ è½½æ´»è·ƒå‘Šè­¦å¤±è´¥:",C),b.value=[],ie.warning("å‘Šè­¦æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥")}},ne=()=>{I()},k=()=>{ve()},$=()=>{console.log("æ›´æ–°åœ°å›¾ç­›é€‰:",_.value)},E=()=>{d.value=!d.value,ie({message:d.value?"å·²è¿›å…¥ç®¡ç†æ¨¡å¼":"å·²é€€å‡ºç®¡ç†æ¨¡å¼",type:d.value?"warning":"info",duration:2e3})},A=async C=>{console.log("äº‹ä»¶å‘¨æœŸå˜åŒ–:",C);try{const h=new Date;let W;switch(C){case"today":W=new Date(h.getFullYear(),h.getMonth(),h.getDate());break;case"week":W=new Date(h.getTime()-10080*60*1e3);break;case"month":W=new Date(h.getTime()-720*60*60*1e3);break;default:W=new Date(h.getTime()-10080*60*1e3)}const B={startTime:W.toISOString(),endTime:h.toISOString()};console.log("é‡æ–°åŠ è½½äº‹ä»¶æ•°æ®ï¼Œå‚æ•°:",B);const G=await s.fetchEvents(B);T.value=G.events||[],console.log(`åŠ è½½${C}äº‹ä»¶æ•°æ®å®Œæˆ:`,T.value.length,"ä¸ªäº‹ä»¶")}catch(h){console.error("é‡æ–°åŠ è½½äº‹ä»¶æ•°æ®å¤±è´¥:",h),ie.error("é‡æ–°åŠ è½½äº‹ä»¶æ•°æ®å¤±è´¥")}},R=async C=>{console.log("ç–²åŠ³åˆ†æç±»å‹å˜åŒ–:",C);try{const h={eventType:"FATIGUE",startTime:new Date(Date.now()-6048e5).toISOString(),endTime:new Date().toISOString()};console.log("é‡æ–°åŠ è½½ç–²åŠ³äº‹ä»¶æ•°æ®ï¼Œå‚æ•°:",h);const B=(await s.fetchEvents(h)).events?.filter(G=>G.eventType==="FATIGUE")||[];T.value=T.value.filter(G=>G.eventType!=="FATIGUE").concat(B),console.log(`åŠ è½½${C}ç–²åŠ³æ•°æ®å®Œæˆ:`,B.length,"ä¸ªç–²åŠ³äº‹ä»¶")}catch(h){console.error("é‡æ–°åŠ è½½ç–²åŠ³æ•°æ®å¤±è´¥:",h),ie.error("é‡æ–°åŠ è½½ç–²åŠ³æ•°æ®å¤±è´¥")}},z=C=>{if(!C)return"æœªçŸ¥";const h=new Date(C),B=new Date-h,G=Math.floor(B/1e3),re=Math.floor(B/6e4),ee=Math.floor(B/36e5),ce=Math.floor(B/864e5);return G<60?`${G}ç§’å‰`:re<60?`${re}åˆ†é’Ÿå‰`:ee<24?`${ee}å°æ—¶å‰`:ce<7?`${ce}å¤©å‰`:h.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},Y=C=>({LOW:"è½»å¾®",MEDIUM:"ä¸­ç­‰",HIGH:"ä¸¥é‡",CRITICAL:"å±æ€¥"})[C]||"æœªçŸ¥",X=C=>C==null?"info":C>=0&&C<60?"success":C>=60&&C<100?"warning":C>=100&&C<120?"":C>=120?"danger":"info",pe=C=>({LOW:"success",MEDIUM:"warning",HIGH:"danger",CRITICAL:"danger"})[C]||"info",Se=C=>({LOW:"Check",MEDIUM:"Warning",HIGH:"Bell",CRITICAL:"Bell"})[C]||"Check",Ue=C=>{console.log("ç‚¹å‡»å‘Šè­¦:",C),ie.info(`æŸ¥çœ‹å‘Šè­¦è¯¦æƒ…: ${C.message}`)},ze=C=>{console.log("è®¾å¤‡ç‚¹å‡»:",C),J.value=C,C.deviceId&&he(C.deviceId)},he=async C=>{try{console.log("åŠ è½½è®¾å¤‡è¯¦æƒ…:",C);const h=await n.fetchDeviceDetail(C);console.log("è®¾å¤‡è¯¦æƒ…:",h),J.value&&J.value.deviceId===C&&(J.value={...J.value,...h})}catch(h){console.error("åŠ è½½è®¾å¤‡è¯¦æƒ…å¤±è´¥:",h),ie.error("åŠ è½½è®¾å¤‡è¯¦æƒ…å¤±è´¥")}},Ge=C=>{console.log("åœ°å›¾å‡†å¤‡å°±ç»ª:",C)},fe=C=>{Ke(C)},Ke=C=>{t.push(`/devices/${C.deviceId}`)},V=()=>{U.value.apiKey=localStorage.getItem("amap_api_key")||"",U.value.securityKey=localStorage.getItem("amap_security_key")||"",U.value.version=localStorage.getItem("amap_version")||"1.4.15",u.value=!0},Be=()=>{if(!U.value.apiKey.trim()){ie.warning("è¯·è¾“å…¥API Key");return}localStorage.setItem("amap_api_key",U.value.apiKey),localStorage.setItem("amap_security_key",U.value.securityKey),localStorage.setItem("amap_version",U.value.version),u.value=!1,ie.success("åœ°å›¾é…ç½®å·²ä¿å­˜"),setTimeout(()=>{window.location.reload()},1e3)},qt=C=>{if(!C)return"æœªçŸ¥";const h=new Date(C),B=new Date-h,G=Math.floor(B/1e3),re=Math.floor(B/6e4),ee=Math.floor(B/36e5),ce=Math.floor(B/864e5);return G<60?`${G}ç§’å‰`:re<60?`${re}åˆ†é’Ÿå‰`:ee<24?`${ee}å°æ—¶å‰`:ce<7?`${ce}å¤©å‰`:h.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},Gt=C=>{console.log("æ”¶åˆ°å®æ—¶æ•°æ®æ¨é€:",C);const{type:h,payload:W}=C;if(h==="realtime_data"){const{deviceId:B,data:G,timestamp:re}=W,ee=r.value.find(ce=>ce.deviceId===B);if(ee){const ce=ee.location,Oe=G.location;if(Object.assign(ee,{location:G.location,speed:G.speed,direction:G.direction,fatigueLevel:G.fatigueLevel,fatigueScore:G.fatigueScore,lastSeen:new Date(re).toISOString()}),ce&&Oe){const xe=Math.abs(Oe.lat-ce.lat),lt=Math.abs(Oe.lng-ce.lng),He=1e-4;(xe>He||lt>He)&&(console.log(`è®¾å¤‡ ${B} ä½ç½®å‘ç”Ÿæ˜¾è‘—å˜åŒ–:`,{from:ce,to:Oe,latDiff:xe,lngDiff:lt}),ie.info(`è®¾å¤‡ ${B} ä½ç½®å·²æ›´æ–°`))}}else r.value.push({deviceId:B,...G,lastSeen:new Date(re).toISOString()}),console.log(`æ–°è®¾å¤‡ ${B} ä¸Šçº¿`),ie.success(`æ–°è®¾å¤‡ ${B} å·²ä¸Šçº¿`);K.value&&K.value.updateMarkers(),st()}},Kt=C=>{console.log("æ”¶åˆ°è®¾å¤‡çŠ¶æ€æ›´æ–°:",C);const{type:h,payload:W}=C;if(h==="device_status"){const{deviceId:B,status:G,timestamp:re}=W,ee=r.value.find(ce=>ce.deviceId===B);ee&&(ee.status=G,ee.lastSeen=new Date(re).toISOString()),ie.info(`è®¾å¤‡ ${B} çŠ¶æ€å˜æ›´ä¸º ${G}`)}},Jt=C=>{console.log("æ”¶åˆ°å‘Šè­¦æ¨é€:",C);const{type:h,payload:W}=C;if(h==="alert"){const{alertType:B,message:G,severity:re}=W;ie({type:{CRITICAL:"error",HIGH:"warning",MEDIUM:"info",LOW:"success"}[re]||"warning",message:`${B}: ${G}`,duration:re==="CRITICAL"?0:5e3,showClose:!0}),(re==="CRITICAL"||re==="HIGH")&&no(re)}},Yt=C=>{console.log("æ”¶åˆ°äº‹ä»¶é€šçŸ¥:",C);const{type:h,payload:W}=C;if(h==="event"){const{eventType:B}=W;if(i.value.eventSummary){const G=new Date().toDateString();i.value.eventSummary[G]||(i.value.eventSummary[G]={total:0,fatigue:0,distraction:0,emergency:0}),i.value.eventSummary[G].total++,i.value.eventSummary[G][B.toLowerCase()]++}}},no=C=>{try{new Audio(`/static/audio/alert_${C.toLowerCase()}.mp3`).play().catch(W=>{console.log("æ— æ³•æ’­æ”¾å‘Šè­¦å£°éŸ³:",W)})}catch(h){console.log("å‘Šè­¦å£°éŸ³æ–‡ä»¶ä¸å­˜åœ¨:",h)}},st=()=>{m.value="åˆšåˆš",y.value=T.value.length,O.value=b.value.filter(C=>C.severity==="CRITICAL"||C.severity==="HIGH").length,x.value=Math.floor(Math.random()*50)+100,N.value=(Math.random()*2+1).toFixed(1)},at=C=>{f.value=C,console.log("WebSocketçŠ¶æ€å˜åŒ–:",C?"å·²è¿æ¥":"å·²æ–­å¼€")};return Ve(async()=>{console.log("=== Dashboardç»„ä»¶å·²æŒ‚è½½ ==="),console.log("å¼€å§‹åŠ è½½æ•°æ®..."),console.log("å½“å‰æ—¶é—´:",new Date().toISOString());try{await ye(),st(),console.log("=== Dashboardæ•°æ®åŠ è½½å®Œæˆ ===")}catch(W){console.error("=== Dashboardæ•°æ®åŠ è½½å¤±è´¥ ===",W)}console.log("å¼€å§‹è¿æ¥WebSocket...");try{le.connect(),console.log("WebSocketè¿æ¥è¯·æ±‚å·²å‘é€")}catch(W){console.error("WebSocketè¿æ¥å¤±è´¥:",W)}le.on("connected",at),le.on("disconnected",at),le.on("realtime_data",Gt),le.on("device_status",Kt),le.on("alert",Jt),le.on("event",Yt),f.value=le.getConnectionStatus().isConnected;const C=setInterval(()=>{console.log("=== å®šæ—¶åˆ·æ–°å®æ—¶æ•°æ® ==="),ve(),st()},3e4),h=setInterval(()=>{st()},5e3);We(()=>{clearInterval(C),clearInterval(h),le.off("connected",at),le.off("disconnected",at),le.off("realtime_data",Gt),le.off("device_status",Kt),le.off("alert",Jt),le.off("event",Yt)})}),(C,h)=>{const W=D("el-button"),B=D("el-col"),G=D("el-row"),re=D("el-tag"),ee=D("el-icon"),ce=D("el-option"),Oe=D("el-select"),xe=D("el-card"),lt=D("el-badge"),He=D("el-input"),Me=D("el-table-column"),oo=D("el-table"),Et=D("el-form-item"),so=D("el-form"),ao=D("el-dialog"),lo=Ut("loading");return L(),H("div",Ul,[l("div",zl,[a(W,{type:d.value?"danger":"primary",icon:d.value?"Lock":"Unlock",onClick:E,size:"small"},{default:c(()=>[M(S(d.value?"é€€å‡ºç®¡ç†":"ç®¡ç†æ¨¡å¼"),1)]),_:1},8,["type","icon"])]),a(G,{gutter:20,class:"overview-section"},{default:c(()=>[a(B,{xs:12,sm:6,md:6,lg:6,xl:6},{default:c(()=>[a(rt,{title:"è®¾å¤‡æ€»æ•°",value:i.value.deviceStatus?.total||0,icon:"Monitor",color:"primary",suffix:"å°",highlight:!0},null,8,["value"])]),_:1}),a(B,{xs:12,sm:6,md:6,lg:6,xl:6},{default:c(()=>[a(rt,{title:"åœ¨çº¿è®¾å¤‡",value:i.value.deviceStatus?.online||0,icon:"CircleCheck",color:"success",suffix:"å°",pulse:i.value.deviceStatus?.online>0},null,8,["value","pulse"])]),_:1}),a(B,{xs:12,sm:6,md:6,lg:6,xl:6},{default:c(()=>[a(rt,{title:"ä»Šæ—¥äº‹ä»¶",value:i.value.eventSummary?.today?.total||0,icon:"Warning",color:"primary",suffix:"èµ·",pulse:i.value.eventSummary?.today?.total>0},null,8,["value","pulse"])]),_:1}),a(B,{xs:12,sm:6,md:6,lg:6,xl:6},{default:c(()=>[a(rt,{title:"æ´»è·ƒå‘Šè­¦",value:i.value.alertSummary?.active||0,icon:"Bell",color:"danger",suffix:"æ¡",pulse:i.value.alertSummary?.active>0,highlight:i.value.alertSummary?.active>0,urgent:i.value.alertSummary?.active>0},null,8,["value","pulse","highlight","urgent"])]),_:1})]),_:1}),a(G,{gutter:20,class:"status-indicators"},{default:c(()=>[a(B,{xs:24,sm:8,md:8,lg:8,xl:8},{default:c(()=>[l("div",Bl,[l("div",Hl,[h[8]||(h[8]=l("span",null,"ç³»ç»ŸçŠ¶æ€",-1)),l("div",{class:Te(["status-dot",oe.value])},[...h[7]||(h[7]=[l("div",{class:"pulse-ring"},null,-1)])],2)]),l("div",Vl,[l("div",Wl,[h[9]||(h[9]=l("span",null,"WebSocketè¿æ¥",-1)),a(re,{type:f.value?"success":"danger",size:"small"},{default:c(()=>[M(S(f.value?"å·²è¿æ¥":"æ–­å¼€"),1)]),_:1},8,["type"])]),l("div",jl,[h[10]||(h[10]=l("span",null,"æ•°æ®æ›´æ–°",-1)),l("span",ql,S(m.value),1)])])])]),_:1}),a(B,{xs:24,sm:8,md:8,lg:8,xl:8},{default:c(()=>[l("div",Gl,[l("div",Kl,[h[11]||(h[11]=l("span",null,"å®æ—¶äº‹ä»¶æµ",-1)),l("div",Jl,[(L(),H(Le,null,Pe(5,P=>l("div",{class:"stream-dot",key:P,style:ro({animationDelay:`${P*.2}s`})},null,4)),64))])]),l("div",Yl,[l("div",Xl,[h[12]||(h[12]=l("span",null,"æœ€è¿‘äº‹ä»¶",-1)),l("span",Ql,S(y.value),1)]),l("div",Zl,[h[13]||(h[13]=l("span",null,"å¤„ç†é€Ÿåº¦",-1)),l("span",er,S(x.value)+"ms",1)])])])]),_:1}),a(B,{xs:24,sm:8,md:8,lg:8,xl:8},{default:c(()=>[l("div",{class:Te(["status-indicator alert-indicator",{"has-critical-alerts":O.value>0}])},[l("div",tr,[h[14]||(h[14]=l("span",null,"å‘Šè­¦ç›‘æ§",-1)),l("div",{class:Te(["alert-monitor",{"has-alerts":b.value.length>0}])},[a(ee,null,{default:c(()=>[a(j(xt))]),_:1}),O.value>0?(L(),H("div",nr,S(O.value),1)):ae("",!0)],2)]),l("div",or,[l("div",sr,[h[15]||(h[15]=l("span",null,"ä¸¥é‡å‘Šè­¦",-1)),l("span",{class:Te(["critical-count",{critical:O.value>0}])},S(O.value),3)]),l("div",ar,[h[16]||(h[16]=l("span",null,"å“åº”æ—¶é—´",-1)),l("span",lr,S(N.value)+"s",1)])])],2)]),_:1})]),_:1}),a(G,{gutter:20,class:"monitoring-section"},{default:c(()=>[a(B,{xs:24,sm:24,md:12,lg:12,xl:12},{default:c(()=>[a(xe,{class:"map-section",shadow:"hover"},{header:c(()=>[l("div",rr,[h[19]||(h[19]=l("span",null,"å®æ—¶è®¾å¤‡ç›‘æ§",-1)),l("div",ir,[l("div",cr,[a(re,{size:"small",type:"success"},{default:c(()=>[M("åœ¨çº¿ "+S(se.value),1)]),_:1}),a(re,{size:"small",type:"warning"},{default:c(()=>[M("ç¦»çº¿ "+S(me.value),1)]),_:1})]),a(Oe,{modelValue:_.value,"onUpdate:modelValue":h[0]||(h[0]=P=>_.value=P),placeholder:"ç­›é€‰è®¾å¤‡çŠ¶æ€",size:"small",clearable:"",style:{"margin-right":"10px",width:"150px"},onChange:$},{default:c(()=>[a(ce,{label:"å…¨éƒ¨è®¾å¤‡",value:""}),a(ce,{label:"åœ¨çº¿è®¾å¤‡",value:"ONLINE"}),a(ce,{label:"ç¦»çº¿è®¾å¤‡",value:"OFFLINE"}),a(ce,{label:"å¤±è”è®¾å¤‡",value:"LOST"})]),_:1},8,["modelValue"]),a(W,{size:"small",onClick:ne},{default:c(()=>[a(ee,null,{default:c(()=>[a(j(De))]),_:1}),h[17]||(h[17]=M(" åˆ·æ–° ",-1))]),_:1}),d.value?(L(),ue(W,{key:0,size:"small",onClick:V},{default:c(()=>[a(ee,null,{default:c(()=>[a(j(Bt))]),_:1}),h[18]||(h[18]=M(" é…ç½® ",-1))]),_:1})):ae("",!0)])])]),default:c(()=>[a(Zo,{ref_key:"mapComponent",ref:K,devices:Z.value,onDeviceClick:ze,onMapReady:Ge},null,8,["devices"])]),_:1})]),_:1}),J.value?(L(),ue(B,{key:0,xs:24,sm:24,md:12,lg:12,xl:12},{default:c(()=>[a(aa,{device:J.value},null,8,["device"])]),_:1})):ae("",!0),a(B,{xs:24,sm:24,md:12,lg:12,xl:12},{default:c(()=>[a(G,{gutter:20,class:"charts-row"},{default:c(()=>[a(B,{span:24},{default:c(()=>[a(xe,{class:"chart-card",shadow:"hover"},{header:c(()=>[...h[20]||(h[20]=[l("span",null,"äº‹ä»¶è¶‹åŠ¿",-1)])]),default:c(()=>[a(xn,{data:T.value,loading:w.value,onPeriodChange:A},null,8,["data","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(G,{gutter:20,class:"analysis-section"},{default:c(()=>[a(B,{xs:24,sm:24,md:12,lg:12,xl:12},{default:c(()=>[a(xe,{class:"chart-card",shadow:"hover"},{header:c(()=>[...h[21]||(h[21]=[l("span",null,"ç–²åŠ³è¡Œä¸ºåˆ†æ",-1)])]),default:c(()=>[a(ls,{data:T.value,loading:w.value,onTypeChange:R},null,8,["data","loading"])]),_:1})]),_:1}),a(B,{xs:24,sm:24,md:12,lg:12,xl:12},{default:c(()=>[a(xe,{class:Te(["alert-panel",{"has-critical-alerts":O.value>0}]),shadow:"hover"},{header:c(()=>[l("div",ur,[h[22]||(h[22]=l("span",null,"å®æ—¶å‘Šè­¦",-1)),l("div",dr,[a(lt,{value:b.value.length,hidden:b.value.length===0,type:"danger"},{default:c(()=>[a(ee,null,{default:c(()=>[a(j(xt))]),_:1})]),_:1},8,["value","hidden"]),O.value>0?(L(),H("span",fr,"ä¸¥é‡å‘Šè­¦ "+S(O.value),1)):ae("",!0)])])]),default:c(()=>[l("div",pr,[(L(!0),H(Le,null,Pe(b.value.slice(0,5),P=>(L(),H("div",{key:P.alertId,class:Te(["alert-item",`alert-${P.severity.toLowerCase()}`]),onClick:Xt=>Ue(P)},[l("div",vr,[a(ee,{class:Te(Se(P.severity))},{default:c(()=>[(L(),ue(ft(Se(P.severity))))]),_:2},1032,["class"])]),l("div",hr,[l("div",gr,S(P.message),1),l("div",yr,[l("span",_r,[a(ee,null,{default:c(()=>[a(j(yn))]),_:1}),M(" "+S(P.deviceId),1)]),l("span",wr,[a(ee,null,{default:c(()=>[a(j(bo))]),_:1}),M(" "+S(z(P.timestamp)),1)])])]),l("div",br,[a(re,{type:pe(P.severity),size:"small"},{default:c(()=>[M(S(Y(P.severity)),1)]),_:2},1032,["type"])])],10,mr))),128)),b.value.length===0?(L(),H("div",Sr,[a(ee,null,{default:c(()=>[a(j(So))]),_:1}),h[23]||(h[23]=l("span",null,"æš‚æ— æ´»è·ƒå‘Šè­¦",-1))])):ae("",!0)])]),_:1},8,["class"])]),_:1})]),_:1}),d.value?(L(),ue(xe,{key:0,class:"device-list-section",shadow:"hover"},{header:c(()=>[l("div",Er,[h[25]||(h[25]=l("span",null,"è®¾å¤‡ç®¡ç†",-1)),l("div",Ir,[a(He,{modelValue:p.value,"onUpdate:modelValue":h[1]||(h[1]=P=>p.value=P),placeholder:"æœç´¢è®¾å¤‡IDæˆ–é©¾é©¶å‘˜",size:"small",style:{width:"200px","margin-right":"10px"},clearable:""},{prefix:c(()=>[a(ee,null,{default:c(()=>[a(j(bn))]),_:1})]),_:1},8,["modelValue"]),a(W,{size:"small",onClick:k},{default:c(()=>[a(ee,null,{default:c(()=>[a(j(De))]),_:1}),h[24]||(h[24]=M(" åˆ·æ–° ",-1))]),_:1})])])]),default:c(()=>[zt((L(),ue(oo,{data:Z.value,stripe:"",style:{width:"100%"},onRowClick:fe},{default:c(()=>[a(Me,{prop:"deviceId",label:"è®¾å¤‡ID",width:"150"}),a(Me,{prop:"username",label:"é©¾é©¶å‘˜",width:"120"}),a(Me,{prop:"status",label:"çŠ¶æ€",width:"100"},{default:c(({row:P})=>[a(Dt,{status:P.status},null,8,["status"])]),_:1}),a(Me,{prop:"healthScore",label:"ç½‘ç»œå¥åº·çŠ¶æ€",width:"120"},{default:c(({row:P})=>[a(Ot,{score:P.healthScore||0},null,8,["score"])]),_:1}),a(Me,{prop:"lastSeen",label:"æœ€åå¿ƒè·³",width:"150"},{default:c(({row:P})=>[M(S(qt(P.lastSeen)),1)]),_:1}),a(Me,{prop:"location",label:"ä½ç½®","min-width":"200"},{default:c(({row:P})=>[P.location&&P.location.lat!==null&&P.location.lng!==null?(L(),H("span",Cr,S(P.location.lat.toFixed(6))+", "+S(P.location.lng.toFixed(6)),1)):(L(),H("span",Tr,"æœªçŸ¥"))]),_:1}),a(Me,{label:"æ“ä½œ",width:"120",fixed:"right"},{default:c(({row:P})=>[a(W,{size:"small",type:"primary",onClick:gn(Xt=>Ke(P),["stop"])},{default:c(()=>[...h[26]||(h[26]=[M(" è¯¦æƒ… ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[lo,j(n).loading]])]),_:1})):(L(),ue(xe,{key:1,class:"device-status-section",shadow:"hover"},{header:c(()=>[l("div",kr,[h[28]||(h[28]=l("span",null,"è®¾å¤‡çŠ¶æ€æ¦‚è§ˆ",-1)),a(W,{size:"small",onClick:k},{default:c(()=>[a(ee,null,{default:c(()=>[a(j(De))]),_:1}),h[27]||(h[27]=M(" åˆ·æ–° ",-1))]),_:1})])]),default:c(()=>[l("div",Ar,[(L(!0),H(Le,null,Pe(Z.value.slice(0,8),P=>(L(),H("div",{key:P.deviceId,class:"device-status-item clean",onClick:Xt=>ze(P)},[l("div",Dr,[l("div",Or,[l("div",Mr,S(P.deviceId),1),l("div",$r,S(P.deviceType||"Muse Pi Pro Plus"),1)]),a(Dt,{status:P.status},null,8,["status"])]),l("div",Rr,[l("div",Lr,S(P.username||P.user?.username||"æœªç»‘å®š"),1),l("div",Pr,"â° "+S(qt(P.lastSeen)),1)]),P.status==="ONLINE"?(L(),H("div",Fr,[l("div",Nr,[P.currentLocation&&P.currentLocation.speed!==null?(L(),H("div",Ur,[h[29]||(h[29]=l("div",{class:"realtime-label"},"é€Ÿåº¦",-1)),a(re,{type:X(P.currentLocation.speed),size:"small",effect:"dark"},{default:c(()=>[M(S(P.currentLocation.speed.toFixed(1))+" km/h ",1)]),_:2},1032,["type"])])):ae("",!0),P.currentLocation&&P.currentLocation.direction!==null?(L(),H("div",zr,[h[30]||(h[30]=l("div",{class:"realtime-label"},"æ–¹å‘",-1)),l("div",Br,S(P.currentLocation.direction.toFixed(0))+"Â°",1)])):ae("",!0),P.currentLocation&&P.currentLocation.satellites!==null?(L(),H("div",Hr,[h[31]||(h[31]=l("div",{class:"realtime-label"},"å«æ˜Ÿ",-1)),l("div",Vr,S(P.currentLocation.satellites)+" é¢—",1)])):ae("",!0),P.currentLocation&&P.currentLocation.altitude!==null?(L(),H("div",Wr,[h[32]||(h[32]=l("div",{class:"realtime-label"},"æµ·æ‹”",-1)),l("div",jr,S(P.currentLocation.altitude.toFixed(1))+"m",1)])):ae("",!0)]),P.currentLocation?ae("",!0):(L(),H("div",qr,[...h[33]||(h[33]=[l("div",{class:"no-data-message"},"æš‚æ— å®æ—¶æ•°æ®",-1)])]))])):(L(),H("div",Gr,[...h[34]||(h[34]=[l("div",{class:"offline-message"},"è®¾å¤‡ç¦»çº¿",-1)])])),l("div",Kr,[h[35]||(h[35]=l("div",{class:"health-label"},"ç½‘ç»œå¥åº·çŠ¶æ€",-1)),a(Ot,{score:P.healthScore||0},null,8,["score"])])],8,xr))),128))])]),_:1})),a(ao,{modelValue:u.value,"onUpdate:modelValue":h[6]||(h[6]=P=>u.value=P),title:"åœ°å›¾é…ç½®",width:"600px","close-on-click-modal":!1},{footer:c(()=>[a(W,{onClick:h[5]||(h[5]=P=>u.value=!1)},{default:c(()=>[...h[39]||(h[39]=[M("å–æ¶ˆ",-1)])]),_:1}),a(W,{type:"primary",onClick:Be},{default:c(()=>[...h[40]||(h[40]=[M("ä¿å­˜",-1)])]),_:1})]),default:c(()=>[a(so,{model:U.value,"label-width":"120px"},{default:c(()=>[a(Et,{label:"é«˜å¾·åœ°å›¾API Key"},{default:c(()=>[a(He,{modelValue:U.value.apiKey,"onUpdate:modelValue":h[2]||(h[2]=P=>U.value.apiKey=P),type:"password",placeholder:"è¯·è¾“å…¥é«˜å¾·åœ°å›¾API Key","show-password":""},null,8,["modelValue"]),h[36]||(h[36]=l("div",{class:"form-tip"},[M(" è¯·åˆ° "),l("a",{href:"https://console.amap.com/",target:"_blank"},"é«˜å¾·å¼€æ”¾å¹³å°"),M(" ç”³è¯·API Key "),l("br"),l("a",{href:"/map-config-help",target:"_blank"},"æŸ¥çœ‹è¯¦ç»†é…ç½®å¸®åŠ©")],-1))]),_:1}),a(Et,{label:"å®‰å…¨å¯†é’¥"},{default:c(()=>[a(He,{modelValue:U.value.securityKey,"onUpdate:modelValue":h[3]||(h[3]=P=>U.value.securityKey=P),type:"password",placeholder:"è¯·è¾“å…¥å®‰å…¨å¯†é’¥ï¼ˆå¯é€‰ï¼‰","show-password":""},null,8,["modelValue"]),h[37]||(h[37]=l("div",{class:"form-tip"}," 2021å¹´åç”³è¯·çš„API Keyéœ€è¦é…ç½®å®‰å…¨å¯†é’¥ï¼Œè¯·åˆ°æ§åˆ¶å°è·å– ",-1))]),_:1}),a(Et,{label:"APIç‰ˆæœ¬"},{default:c(()=>[a(Oe,{modelValue:U.value.version,"onUpdate:modelValue":h[4]||(h[4]=P=>U.value.version=P),placeholder:"é€‰æ‹©APIç‰ˆæœ¬"},{default:c(()=>[a(ce,{label:"åŸºç¡€ç‰ˆ v1.4.15",value:"1.4.15"}),a(ce,{label:"æ ‡å‡†ç‰ˆ v2.0",value:"2.0"})]),_:1},8,["modelValue"]),h[38]||(h[38]=l("div",{class:"form-tip"}," åŸºç¡€ç‰ˆåŠŸèƒ½è¾ƒå°‘ä½†è°ƒç”¨é™åˆ¶è¾ƒå°‘ï¼Œæ ‡å‡†ç‰ˆåŠŸèƒ½å®Œæ•´ä½†æœ‰é™åˆ¶ ",-1))]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),Yr=Ce(Jr,[["__scopeId","data-v-854d162b"]]),Xr={class:"map-controls"},Qr={key:0,class:"time-controls"},Zr={key:1,class:"map-error"},ei={key:2,class:"map-loading"},ti={__name:"SimpleTrackMap",props:{deviceId:{type:String,required:!0},trackData:{type:Array,default:()=>[]},events:{type:Array,default:()=>[]},center:{type:Object,default:()=>({lat:33.553733,lng:119.030953})},zoom:{type:Number,default:12}},emits:["event-click","map-ready"],setup(e,{expose:t,emit:n}){const o=e,s=n,i=F(null),r=F(!1),p=F(""),_=F(!1),u=F(0);let d=null,w=null,T=[],b=[],f=null,m=null,y=null;const x=F(""),O=()=>{const E="732a364f70864bb0c4ac3395cc3d5503";localStorage.getItem("amap_api_key"),x.value=E},N=async()=>{if(console.log("å¼€å§‹åˆå§‹åŒ–SimpleTrackMap..."),console.log("API Key:",x.value?"å·²é…ç½®":"æœªé…ç½®"),console.log("åœ°å›¾å®¹å™¨:",i.value),!x.value){p.value="é«˜å¾·åœ°å›¾API keyæœªé…ç½®";return}if(!i.value){p.value="åœ°å›¾å®¹å™¨æœªæ‰¾åˆ°";return}r.value=!0,p.value="";try{if(window.AMap||(console.log("åŠ è½½é«˜å¾·åœ°å›¾API..."),await U()),!window.AMap)throw new Error("é«˜å¾·åœ°å›¾APIåŠ è½½å¤±è´¥");console.log("AMapå·²åŠ è½½ï¼Œå¼€å§‹åˆ›å»ºSimpleTrackMapå®ä¾‹..."),console.log("åœ°å›¾å®¹å™¨å°ºå¯¸:",i.value.offsetWidth,"x",i.value.offsetHeight),d=new window.AMap.Map(i.value,{center:[o.center.lng,o.center.lat],zoom:o.zoom,mapStyle:"amap://styles/normal"}),console.log("SimpleTrackMapå®ä¾‹åˆ›å»ºæˆåŠŸ"),m=new window.AMap.InfoWindow({offset:new window.AMap.Pixel(0,-30)}),d.on("complete",()=>{console.log("SimpleTrackMapåœ°å›¾åŠ è½½å®Œæˆ"),s("map-ready",d),K(),J(),r.value=!1})}catch(E){console.error("SimpleTrackMapåœ°å›¾åˆå§‹åŒ–å¤±è´¥:",E),p.value=E.message||"åœ°å›¾åˆå§‹åŒ–å¤±è´¥",r.value=!1}},U=()=>new Promise((E,A)=>{if(window.AMap){E();return}const R=localStorage.getItem("amap_version")||"1.4.15",z=document.createElement("script");z.src=`https://webapi.amap.com/maps?v=${R}&key=${x.value}`,z.onload=()=>{const Y=()=>{window.AMap&&window.AMap.Map?E():setTimeout(Y,100)};Y()},z.onerror=()=>{A(new Error("é«˜å¾·åœ°å›¾APIåŠ è½½å¤±è´¥"))},document.head.appendChild(z)}),K=()=>{if(!d||!o.trackData.length)return;w&&d.remove(w),T.forEach(A=>d.remove(A)),T=[];const E=o.trackData.map(A=>[A.lng,A.lat]);w=new window.AMap.Polyline({path:E,strokeColor:"#409EFF",strokeWeight:3,strokeOpacity:.8}),d.add(w),o.trackData.forEach((A,R)=>{const z=new window.AMap.Marker({position:[A.lng,A.lat],title:`è½¨è¿¹ç‚¹ ${R+1}`,icon:Z(R),anchor:"center"});z.on("click",()=>{se(A,z)}),T.push(z),d.add(z)}),E.length>0&&d.setFitView(T)},J=()=>{!d||!o.events.length||(b.forEach(E=>d.remove(E)),b=[],o.events.forEach(E=>{if(E.location&&E.location.lat&&E.location.lng){const A=new window.AMap.Marker({position:[E.location.lng,E.location.lat],title:k(E.eventType),icon:oe(E.severity),anchor:"center"});A.on("click",()=>{me(E,A),s("event-click",E)}),b.push(A),d.add(A)}}))},Z=E=>E===0?"https://webapi.amap.com/theme/v1.3/markers/n/mark_g.png":E===o.trackData.length-1?"https://webapi.amap.com/theme/v1.3/markers/n/mark_r.png":"https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png",oe=E=>{const A={LOW:"https://webapi.amap.com/theme/v1.3/markers/n/mark_g.png",MEDIUM:"https://webapi.amap.com/theme/v1.3/markers/n/mark_y.png",HIGH:"https://webapi.amap.com/theme/v1.3/markers/n/mark_r.png",CRITICAL:"https://webapi.amap.com/theme/v1.3/markers/n/mark_r.png"};return A[E]||A.MEDIUM},se=(E,A)=>{const R=`
    <div class="track-point-info">
      <h4>è½¨è¿¹ç‚¹</h4>
      <p><strong>æ—¶é—´:</strong> ${ne(E.timestamp)}</p>
      <p><strong>ä½ç½®:</strong> ${E.lat.toFixed(6)}, ${E.lng.toFixed(6)}</p>
      <p><strong>é€Ÿåº¦:</strong> ${E.speed||0} km/h</p>
      <p><strong>æ–¹å‘:</strong> ${E.direction||0}Â°</p>
    </div>
  `;m.setContent(R),m.open(d,A.getPosition())},me=(E,A)=>{const R=`
    <div class="event-info">
      <h4>${k(E.eventType)}</h4>
      <p><strong>ä¸¥é‡ç¨‹åº¦:</strong> ${$(E.severity)}</p>
      <p><strong>ç½®ä¿¡åº¦:</strong> ${(E.confidence*100).toFixed(1)}%</p>
      <p><strong>æ—¶é—´:</strong> ${ne(E.timestamp)}</p>
      <p><strong>æè¿°:</strong> ${E.context||"æ— "}</p>
    </div>
  `;m.setContent(R),m.open(d,A.getPosition())},ye=()=>{o.trackData.length&&(_.value?(y&&(clearInterval(y),y=null),_.value=!1):(_.value=!0,u.value=0,y=setInterval(()=>{u.value<o.trackData.length-1?(u.value++,ve(u.value)):(y&&(clearInterval(y),y=null),_.value=!1)},1e3)))},be=()=>{y&&(clearInterval(y),y=null),_.value=!1,u.value=0,K()},ve=E=>{if(!d||!o.trackData[E])return;const A=o.trackData[E];d.setCenter([A.lng,A.lat]),f&&d.remove(f),f=new window.AMap.Marker({position:[A.lng,A.lat],title:"å½“å‰ä½ç½®",icon:"https://webapi.amap.com/theme/v1.3/markers/n/mark_r.png",anchor:"center"}),d.add(f)},I=()=>{d&&o.trackData.length>0?d.setFitView(T):d&&d.setCenter([o.center.lng,o.center.lat])},v=()=>{p.value="",d&&(d.destroy(),d=null),N()},te=E=>o.trackData[E]?ne(o.trackData[E].timestamp):"",ne=E=>E?new Date(E).toLocaleString():"æœªçŸ¥",k=E=>({FATIGUE:"ç–²åŠ³æ£€æµ‹",DISTRACTION:"åˆ†å¿ƒè¡Œä¸º",EMERGENCY:"ç´§æ€¥äº‹ä»¶"})[E]||"æœªçŸ¥äº‹ä»¶",$=E=>({LOW:"è½»å¾®",MEDIUM:"ä¸­ç­‰",HIGH:"ä¸¥é‡",CRITICAL:"å±æ€¥"})[E]||"æœªçŸ¥";return Re(()=>o.trackData,K,{deep:!0}),Re(()=>o.events,J,{deep:!0}),Re(()=>x.value,E=>{E&&!d&&N()}),Ve(()=>{O(),hn(()=>{x.value&&N()})}),We(()=>{y&&clearInterval(y),d&&d.destroy()}),t({centerMap:I,updateTrackDisplay:K,updateEventMarkers:J,getMap:()=>d}),(E,A)=>{const R=D("el-icon"),z=D("el-button"),Y=D("el-button-group"),X=D("el-slider"),pe=D("el-alert");return L(),H("div",{class:"simple-track-map",ref_key:"mapContainer",ref:i},[l("div",Xr,[a(Y,null,{default:c(()=>[a(z,{size:"small",onClick:ye,disabled:!e.trackData.length},{default:c(()=>[a(R,null,{default:c(()=>[a(j(Eo))]),_:1}),M(" "+S(_.value?"æš‚åœ":"æ’­æ”¾"),1)]),_:1},8,["disabled"]),a(z,{size:"small",onClick:be},{default:c(()=>[a(R,null,{default:c(()=>[a(j(De))]),_:1}),A[1]||(A[1]=M(" é‡ç½® ",-1))]),_:1}),a(z,{size:"small",onClick:I},{default:c(()=>[a(R,null,{default:c(()=>[a(j(_n))]),_:1}),A[2]||(A[2]=M(" å±…ä¸­ ",-1))]),_:1})]),_:1})]),e.trackData.length?(L(),H("div",Qr,[a(X,{modelValue:u.value,"onUpdate:modelValue":A[0]||(A[0]=Se=>u.value=Se),min:0,max:e.trackData.length-1,step:1,onChange:ve,"format-tooltip":te},null,8,["modelValue","max"])])):ae("",!0),p.value?(L(),H("div",Zr,[a(pe,{title:"åœ°å›¾åŠ è½½å¤±è´¥",description:p.value,type:"error","show-icon":"",closable:!1},null,8,["description"]),a(z,{onClick:v,style:{"margin-top":"10px"}},{default:c(()=>[...A[3]||(A[3]=[M("é‡è¯•",-1)])]),_:1})])):ae("",!0),r.value?(L(),H("div",ei,[a(R,{class:"is-loading"},{default:c(()=>[a(j(wn))]),_:1}),A[4]||(A[4]=l("span",null,"åœ°å›¾åŠ è½½ä¸­...",-1))])):ae("",!0)],512)}}},ni=Ce(ti,[["__scopeId","data-v-89efa1a2"]]),oi={class:"device-detail"},si={class:"page-header"},ai={key:0,class:"device-info"},li={class:"info-item"},ri={class:"info-item"},ii={class:"info-item"},ci={class:"info-item"},ui={class:"info-item"},di={class:"info-item"},fi={class:"info-item"},pi={class:"info-item"},mi={key:0,class:"data-grid"},vi={class:"data-item"},hi={class:"data-item"},gi={class:"data-item"},yi={class:"data-item"},_i={class:"data-item"},wi={class:"data-item"},bi={key:0,class:"stats-grid"},Si={class:"stat-item"},Ei={class:"stat-value"},Ii={class:"stat-item"},Ci={class:"stat-value"},Ti={class:"stat-item"},ki={class:"stat-value"},Ai={class:"stat-item"},xi={class:"stat-value"},Di={class:"stat-item"},Oi={class:"stat-value"},Mi={class:"event-context"},$i={class:"event-details"},Ri={class:"header-actions"},Li={key:0,class:"event-detail"},Pi={__name:"DeviceDetail",setup(e){const t=vn(),n=Nt(),o=jt(),s=vt(),i=Q(()=>t.params.deviceId),r=Q(()=>o.currentDevice),p=F([]),_=F([]),u=F(!1),d=F(null),w=F(!1),T=F({apiKey:""}),b=()=>{n.go(-1)},f=async()=>{try{await o.fetchDeviceDetail(i.value)}catch(I){console.error("åŠ è½½è®¾å¤‡è¯¦æƒ…å¤±è´¥:",I),ie.error("åŠ è½½è®¾å¤‡è¯¦æƒ…å¤±è´¥")}},m=async()=>{try{const I={deviceId:i.value,eventType:"FATIGUE",limit:10},v=await s.fetchEvents(I);p.value=v.events||[]}catch(I){console.error("åŠ è½½äº‹ä»¶å†å²å¤±è´¥:",I)}},y=async()=>{try{const I=new Date,te={startTime:new Date(I.getTime()-1440*60*1e3).toISOString(),endTime:I.toISOString()},ne=await o.fetchDeviceTrack(i.value,te);_.value=ne.track||[]}catch(I){console.error("åŠ è½½è½¨è¿¹æ•°æ®å¤±è´¥:",I)}},x=()=>{f()},O=I=>{console.log("æ˜¾ç¤ºäº‹ä»¶ä½ç½®:",I)},N=I=>{d.value=I,u.value=!0},U=()=>{T.value.apiKey=localStorage.getItem("amap_api_key")||"",w.value=!0},K=()=>{if(!T.value.apiKey.trim()){ie.warning("è¯·è¾“å…¥API Key");return}localStorage.setItem("amap_api_key",T.value.apiKey),w.value=!1,ie.success("åœ°å›¾é…ç½®å·²ä¿å­˜"),setTimeout(()=>{window.location.reload()},1e3)},J=I=>I?new Date(I).toLocaleString():"æœªçŸ¥",Z=I=>I?`${I.lat.toFixed(6)}, ${I.lng.toFixed(6)}`:"æœªçŸ¥",oe=I=>{if(!I)return"0åˆ†é’Ÿ";const v=Math.floor(I/3600),te=Math.floor(I%3600/60);return v>0?`${v}å°æ—¶${te}åˆ†é’Ÿ`:`${te}åˆ†é’Ÿ`},se=I=>I?I<1?"ä¼˜ç§€":I<2?"è‰¯å¥½":I<5?"ä¸€èˆ¬":"è¾ƒå·®":"æœªçŸ¥",me=I=>({FATIGUE:"ç–²åŠ³æ£€æµ‹",DISTRACTION:"åˆ†å¿ƒè¡Œä¸º",EMERGENCY:"ç´§æ€¥äº‹ä»¶"})[I]||"æœªçŸ¥äº‹ä»¶",ye=I=>({LOW:"è½»å¾®",MEDIUM:"ä¸­ç­‰",HIGH:"ä¸¥é‡",CRITICAL:"å±æ€¥"})[I]||"æœªçŸ¥",be=I=>({LOW:"success",MEDIUM:"warning",HIGH:"danger",CRITICAL:"danger"})[I]||"info",ve=I=>{I.deviceId===i.value&&f()};return Ve(()=>{f(),m(),y(),le.on("realtime_data",ve);const I=setInterval(()=>{f()},3e4);We(()=>{clearInterval(I),le.off("realtime_data",ve)})}),(I,v)=>{const te=D("el-icon"),ne=D("el-button"),k=D("el-card"),$=D("el-empty"),E=D("el-tag"),A=D("el-timeline-item"),R=D("el-timeline"),z=D("el-col"),Y=D("el-row"),X=D("el-descriptions-item"),pe=D("el-descriptions"),Se=D("el-dialog"),Ue=D("el-input"),ze=D("el-form-item"),he=D("el-form"),Ge=Ut("loading");return L(),H("div",oi,[l("div",si,[a(ne,{onClick:b,size:"small"},{default:c(()=>[a(te,null,{default:c(()=>[a(j(Io))]),_:1}),v[4]||(v[4]=M(" è¿”å› ",-1))]),_:1}),l("h2",null,"è®¾å¤‡è¯¦æƒ… - "+S(i.value),1)]),zt((L(),ue(Y,{gutter:20},{default:c(()=>[a(z,{xs:24,sm:24,md:10,lg:10,xl:10},{default:c(()=>[a(k,{class:"info-panel",shadow:"hover"},{header:c(()=>[...v[5]||(v[5]=[l("span",null,"è®¾å¤‡ä¿¡æ¯",-1)])]),default:c(()=>[r.value?(L(),H("div",ai,[l("div",li,[v[6]||(v[6]=l("label",null,"è®¾å¤‡ID:",-1)),l("span",null,S(r.value.deviceId),1)]),l("div",ri,[v[7]||(v[7]=l("label",null,"è®¾å¤‡ç±»å‹:",-1)),l("span",null,S(r.value.deviceType),1)]),l("div",ii,[v[8]||(v[8]=l("label",null,"ç‰ˆæœ¬:",-1)),l("span",null,S(r.value.version),1)]),l("div",ci,[v[9]||(v[9]=l("label",null,"é©¾é©¶å‘˜:",-1)),l("span",null,S(r.value.user?.username||"æœªçŸ¥"),1)]),l("div",ui,[v[10]||(v[10]=l("label",null,"è”ç³»æ–¹å¼:",-1)),l("span",null,S(r.value.user?.phone||"æœªçŸ¥"),1)]),l("div",di,[v[11]||(v[11]=l("label",null,"çŠ¶æ€:",-1)),a(Dt,{status:r.value.status},null,8,["status"])]),l("div",fi,[v[12]||(v[12]=l("label",null,"ç½‘ç»œå¥åº·çŠ¶æ€:",-1)),a(Ot,{score:r.value.healthScore||0},null,8,["score"])]),l("div",pi,[v[13]||(v[13]=l("label",null,"æœ€åå¿ƒè·³:",-1)),l("span",null,S(J(r.value.lastSeen)),1)])])):ae("",!0)]),_:1}),a(k,{class:"realtime-data",shadow:"hover"},{header:c(()=>[v[15]||(v[15]=l("span",null,"å®æ—¶æ•°æ®",-1)),a(ne,{size:"small",onClick:x},{default:c(()=>[a(te,null,{default:c(()=>[a(j(De))]),_:1}),v[14]||(v[14]=M(" åˆ·æ–° ",-1))]),_:1})]),default:c(()=>[r.value?.currentLocation?(L(),H("div",mi,[l("div",vi,[v[16]||(v[16]=l("label",null,"ä½ç½®:",-1)),l("span",null,S(Z(r.value.currentLocation)),1)]),l("div",hi,[v[17]||(v[17]=l("label",null,"é€Ÿåº¦:",-1)),l("span",null,S(r.value.currentLocation.speed||0)+" km/h",1)]),l("div",gi,[v[18]||(v[18]=l("label",null,"æ–¹å‘:",-1)),l("span",null,S(r.value.currentLocation.direction||0)+"Â°",1)]),l("div",yi,[v[19]||(v[19]=l("label",null,"æµ·æ‹”:",-1)),l("span",null,S(r.value.currentLocation.altitude||0)+"m",1)]),l("div",_i,[v[20]||(v[20]=l("label",null,"GPSè´¨é‡:",-1)),l("span",null,S(se(r.value.currentLocation.hdop)),1)]),l("div",wi,[v[21]||(v[21]=l("label",null,"å«æ˜Ÿæ•°:",-1)),l("span",null,S(r.value.currentLocation.satellites||0)+"é¢—",1)])])):(L(),ue($,{key:1,description:"æš‚æ— å®æ—¶æ•°æ®"}))]),_:1}),a(k,{class:"fatigue-stats",shadow:"hover"},{header:c(()=>[...v[22]||(v[22]=[l("span",null,"ç–²åŠ³è¡Œä¸ºç»Ÿè®¡",-1)])]),default:c(()=>[r.value?.statistics?(L(),H("div",bi,[l("div",Si,[v[23]||(v[23]=l("label",null,"ä»Šæ—¥ç–²åŠ³äº‹ä»¶:",-1)),l("span",Ei,S(r.value.statistics.fatigueEvents||0),1)]),l("div",Ii,[v[24]||(v[24]=l("label",null,"ä»Šæ—¥åˆ†å¿ƒäº‹ä»¶:",-1)),l("span",Ci,S(r.value.statistics.distractionEvents||0),1)]),l("div",Ti,[v[25]||(v[25]=l("label",null,"æ€»é©¾é©¶æ—¶é•¿:",-1)),l("span",ki,S(oe(r.value.statistics.totalDrivingTime)),1)]),l("div",Ai,[v[26]||(v[26]=l("label",null,"æ€»è¡Œé©¶è·ç¦»:",-1)),l("span",xi,S(r.value.statistics.totalDistance||0)+" km",1)]),l("div",Di,[v[27]||(v[27]=l("label",null,"æœ€åç–²åŠ³äº‹ä»¶:",-1)),l("span",Oi,S(J(r.value.statistics.lastFatigueEvent)),1)])])):(L(),ue($,{key:1,description:"æš‚æ— ç»Ÿè®¡æ•°æ®"}))]),_:1}),a(k,{class:"event-history",shadow:"hover"},{header:c(()=>[v[29]||(v[29]=l("span",null,"å†å²ç–²åŠ³äº‹ä»¶",-1)),a(ne,{size:"small",onClick:m},{default:c(()=>[a(te,null,{default:c(()=>[a(j(De))]),_:1}),v[28]||(v[28]=M(" åˆ·æ–° ",-1))]),_:1})]),default:c(()=>[p.value.length?(L(),ue(R,{key:0},{default:c(()=>[(L(!0),H(Le,null,Pe(p.value,fe=>(L(),ue(A,{key:fe.eventId,timestamp:J(fe.timestamp),type:be(fe.severity),onClick:Ke=>O(fe)},{default:c(()=>[a(E,{type:be(fe.severity),size:"small"},{default:c(()=>[M(S(me(fe.eventType)),1)]),_:2},1032,["type"]),l("p",Mi,S(fe.context),1),l("p",$i," ç½®ä¿¡åº¦: "+S((fe.confidence*100).toFixed(1))+"% | æŒç»­æ—¶é—´: "+S(fe.duration)+"ç§’ ",1)]),_:2},1032,["timestamp","type","onClick"]))),128))]),_:1})):(L(),ue($,{key:1,description:"æš‚æ— ç–²åŠ³äº‹ä»¶"}))]),_:1})]),_:1}),a(z,{xs:24,sm:24,md:14,lg:14,xl:14},{default:c(()=>[a(k,{class:"map-panel",shadow:"hover"},{header:c(()=>[v[32]||(v[32]=l("span",null,"è®¾å¤‡è½¨è¿¹ä¸äº‹ä»¶ä½ç½®",-1)),l("div",Ri,[a(ne,{size:"small",onClick:y},{default:c(()=>[a(te,null,{default:c(()=>[a(j(De))]),_:1}),v[30]||(v[30]=M(" åˆ·æ–°è½¨è¿¹ ",-1))]),_:1}),a(ne,{size:"small",onClick:U},{default:c(()=>[a(te,null,{default:c(()=>[a(j(Bt))]),_:1}),v[31]||(v[31]=M(" é…ç½® ",-1))]),_:1})])]),default:c(()=>[a(ni,{"device-id":i.value,"track-data":_.value,events:p.value,onEventClick:N},null,8,["device-id","track-data","events"])]),_:1})]),_:1})]),_:1})),[[Ge,j(o).loading]]),a(Se,{modelValue:u.value,"onUpdate:modelValue":v[0]||(v[0]=fe=>u.value=fe),title:"äº‹ä»¶è¯¦æƒ…",width:"600px"},{default:c(()=>[d.value?(L(),H("div",Li,[a(pe,{column:2,border:""},{default:c(()=>[a(X,{label:"äº‹ä»¶ID"},{default:c(()=>[M(S(d.value.eventId),1)]),_:1}),a(X,{label:"è®¾å¤‡ID"},{default:c(()=>[M(S(d.value.deviceId),1)]),_:1}),a(X,{label:"äº‹ä»¶ç±»å‹"},{default:c(()=>[M(S(me(d.value.eventType)),1)]),_:1}),a(X,{label:"ä¸¥é‡ç¨‹åº¦"},{default:c(()=>[M(S(ye(d.value.severity)),1)]),_:1}),a(X,{label:"ç½®ä¿¡åº¦"},{default:c(()=>[M(S((d.value.confidence*100).toFixed(1))+"%",1)]),_:1}),a(X,{label:"æŒç»­æ—¶é—´"},{default:c(()=>[M(S(d.value.duration)+"ç§’",1)]),_:1}),a(X,{label:"å‘ç”Ÿæ—¶é—´",span:2},{default:c(()=>[M(S(J(d.value.timestamp)),1)]),_:1}),a(X,{label:"ä½ç½®",span:2},{default:c(()=>[M(S(Z(d.value.location)),1)]),_:1}),a(X,{label:"è¡Œä¸ºæè¿°",span:2},{default:c(()=>[M(S(d.value.behavior),1)]),_:1}),a(X,{label:"ä¸Šä¸‹æ–‡",span:2},{default:c(()=>[M(S(d.value.context),1)]),_:1})]),_:1})])):ae("",!0)]),_:1},8,["modelValue"]),a(Se,{modelValue:w.value,"onUpdate:modelValue":v[3]||(v[3]=fe=>w.value=fe),title:"åœ°å›¾é…ç½®",width:"500px","close-on-click-modal":!1},{footer:c(()=>[a(ne,{onClick:v[2]||(v[2]=fe=>w.value=!1)},{default:c(()=>[...v[34]||(v[34]=[M("å–æ¶ˆ",-1)])]),_:1}),a(ne,{type:"primary",onClick:K},{default:c(()=>[...v[35]||(v[35]=[M("ä¿å­˜",-1)])]),_:1})]),default:c(()=>[a(he,{model:T.value,"label-width":"100px"},{default:c(()=>[a(ze,{label:"é«˜å¾·åœ°å›¾API Key"},{default:c(()=>[a(Ue,{modelValue:T.value.apiKey,"onUpdate:modelValue":v[1]||(v[1]=fe=>T.value.apiKey=fe),type:"password",placeholder:"è¯·è¾“å…¥é«˜å¾·åœ°å›¾API Key","show-password":""},null,8,["modelValue"]),v[33]||(v[33]=l("div",{class:"form-tip"},[M(" è¯·åˆ° "),l("a",{href:"https://console.amap.com/",target:"_blank"},"é«˜å¾·å¼€æ”¾å¹³å°"),M(" ç”³è¯·API Key ")],-1))]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Fi=Ce(Pi,[["__scopeId","data-v-a647df8b"]]),Ni={class:"event-management"},Ui={class:"page-header"},zi={class:"header-actions"},Bi={class:"card-header"},Hi={class:"header-info"},Vi={class:"pagination-wrapper"},Wi={class:"severity-stats"},ji={class:"severity-label"},qi={class:"severity-count"},Gi={class:"severity-percentage"},Ki={class:"device-stats"},Ji={class:"device-info"},Yi={class:"device-id"},Xi={class:"device-user"},Qi={class:"device-count"},Zi={key:0,class:"event-detail"},ec={__name:"EventManagement",setup(e){Nt();const t=vt(),n=jt(),o=F({deviceId:"",eventType:"",severity:"",timeRange:[]}),s=F({currentPage:1,pageSize:20,total:0}),i=F(!1),r=F(null),p=Q(()=>n.devices),_=Q(()=>{const I={LOW:0,MEDIUM:0,HIGH:0,CRITICAL:0};return t.events.forEach(v=>{I.hasOwnProperty(v.severity)&&I[v.severity]++}),I}),u=Q(()=>{const I={};return t.events.forEach(v=>{I[v.deviceId]||(I[v.deviceId]={deviceId:v.deviceId,username:v.user?.username||"æœªçŸ¥",eventCount:0}),I[v.deviceId].eventCount++}),Object.values(I).sort((v,te)=>te.eventCount-v.eventCount)}),d=async()=>{try{console.log("=== EventManagement: å¼€å§‹åŠ è½½äº‹ä»¶åˆ—è¡¨ ===");const I={...T()};console.log("åŠ è½½å‚æ•°:",I);const v=await t.fetchEvents(I);console.log("=== EventManagement: äº‹ä»¶åˆ—è¡¨åŠ è½½å®Œæˆ ==="),console.log("å“åº”æ•°æ®:",v),console.log("å½“å‰äº‹ä»¶æ•°é‡:",t.events.length),console.log("äº‹ä»¶åˆ—è¡¨:",t.events),s.value.total=v.total||0}catch(I){console.error("åŠ è½½äº‹ä»¶åˆ—è¡¨å¤±è´¥:",I),ie.error("åŠ è½½äº‹ä»¶åˆ—è¡¨å¤±è´¥")}},w=async()=>{try{await n.fetchDevices()}catch(I){console.error("åŠ è½½è®¾å¤‡åˆ—è¡¨å¤±è´¥:",I)}},T=()=>{const I={};return o.value.deviceId&&(I.deviceId=o.value.deviceId),o.value.eventType&&(I.eventType=o.value.eventType),o.value.severity&&(I.severity=o.value.severity),o.value.timeRange&&o.value.timeRange.length===2&&(I.startTime=o.value.timeRange[0],I.endTime=o.value.timeRange[1]),I},b=()=>{s.value.currentPage=1,d()},f=()=>{o.value={deviceId:"",eventType:"",severity:"",timeRange:[]},s.value.currentPage=1,d()},m=()=>{d()},y=()=>{ie.info("å¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­...")},x=I=>{O(I)},O=I=>{r.value=I,i.value=!0},N=I=>{s.value.pageSize=I,s.value.currentPage=1,d()},U=I=>{s.value.currentPage=I,d()},K=I=>{d()},J=I=>I?new Date(I).toLocaleString():"æœªçŸ¥",Z=I=>I?`${I.lat.toFixed(6)}, ${I.lng.toFixed(6)}`:"æœªçŸ¥",oe=I=>({FATIGUE:"ç–²åŠ³æ£€æµ‹",DISTRACTION:"åˆ†å¿ƒè¡Œä¸º",EMERGENCY:"ç´§æ€¥äº‹ä»¶"})[I]||"æœªçŸ¥äº‹ä»¶",se=I=>({FATIGUE:"warning",DISTRACTION:"danger",EMERGENCY:"danger"})[I]||"info",me=I=>({LOW:"è½»å¾®",MEDIUM:"ä¸­ç­‰",HIGH:"ä¸¥é‡",CRITICAL:"å±æ€¥"})[I]||"æœªçŸ¥",ye=I=>({LOW:"success",MEDIUM:"warning",HIGH:"danger",CRITICAL:"danger"})[I]||"info",be=I=>{const v=t.events.length;return v===0?0:(I/v*100).toFixed(1)},ve=I=>{console.log("æ”¶åˆ°æ–°äº‹ä»¶æ¨é€:",I);const{type:v,payload:te}=I;if(v==="event"){const{deviceId:ne,eventType:k,data:$,timestamp:E}=te,A={eventId:$.eventId||`EVENT_${Date.now()}`,deviceId:ne,eventType:k,severity:$.severity||"MEDIUM",location:$.location,behavior:$.behavior,confidence:$.confidence,duration:$.duration,alertLevel:$.alertLevel,context:$.context,timestamp:new Date(E).toISOString(),user:{username:"å®æ—¶æ¨é€"}};t.events.unshift(A),ie.success(`æ”¶åˆ°æ–°äº‹ä»¶: ${k}`);try{new Audio("/static/audio/alert_mid.mp3").play().catch(()=>{})}catch(R){console.log("æ— æ³•æ’­æ”¾æç¤ºéŸ³:",R)}}};return Ve(()=>{w(),d(),le.on("event",ve);const I=setInterval(()=>{d()},3e5);We(()=>{clearInterval(I),le.off("event",ve)})}),(I,v)=>{const te=D("el-icon"),ne=D("el-button"),k=D("el-option"),$=D("el-select"),E=D("el-form-item"),A=D("el-date-picker"),R=D("el-form"),z=D("el-card"),Y=D("el-table-column"),X=D("el-tag"),pe=D("el-table"),Se=D("el-pagination"),Ue=D("el-col"),ze=D("el-row"),he=D("el-descriptions-item"),Ge=D("el-descriptions"),fe=D("el-dialog"),Ke=Ut("loading");return L(),H("div",Ni,[l("div",Ui,[v[9]||(v[9]=l("h2",null,"äº‹ä»¶ç®¡ç†",-1)),l("div",zi,[a(ne,{onClick:m},{default:c(()=>[a(te,null,{default:c(()=>[a(j(De))]),_:1}),v[7]||(v[7]=M(" åˆ·æ–° ",-1))]),_:1}),a(ne,{onClick:y},{default:c(()=>[a(te,null,{default:c(()=>[a(j(Co))]),_:1}),v[8]||(v[8]=M(" å¯¼å‡º ",-1))]),_:1})])]),a(z,{class:"filter-section",shadow:"hover"},{default:c(()=>[a(R,{model:o.value,inline:""},{default:c(()=>[a(E,{label:"è®¾å¤‡"},{default:c(()=>[a($,{modelValue:o.value.deviceId,"onUpdate:modelValue":v[0]||(v[0]=V=>o.value.deviceId=V),placeholder:"é€‰æ‹©è®¾å¤‡",clearable:"",style:{width:"200px"}},{default:c(()=>[(L(!0),H(Le,null,Pe(p.value,V=>(L(),ue(k,{key:V.deviceId,label:`${V.deviceId} (${V.username})`,value:V.deviceId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(E,{label:"äº‹ä»¶ç±»å‹"},{default:c(()=>[a($,{modelValue:o.value.eventType,"onUpdate:modelValue":v[1]||(v[1]=V=>o.value.eventType=V),placeholder:"é€‰æ‹©äº‹ä»¶ç±»å‹",clearable:"",style:{width:"150px"}},{default:c(()=>[a(k,{label:"ç–²åŠ³æ£€æµ‹",value:"FATIGUE"}),a(k,{label:"åˆ†å¿ƒè¡Œä¸º",value:"DISTRACTION"}),a(k,{label:"ç´§æ€¥äº‹ä»¶",value:"EMERGENCY"})]),_:1},8,["modelValue"])]),_:1}),a(E,{label:"ä¸¥é‡ç¨‹åº¦"},{default:c(()=>[a($,{modelValue:o.value.severity,"onUpdate:modelValue":v[2]||(v[2]=V=>o.value.severity=V),placeholder:"é€‰æ‹©ä¸¥é‡ç¨‹åº¦",clearable:"",style:{width:"150px"}},{default:c(()=>[a(k,{label:"è½»å¾®",value:"LOW"}),a(k,{label:"ä¸­ç­‰",value:"MEDIUM"}),a(k,{label:"ä¸¥é‡",value:"HIGH"}),a(k,{label:"å±æ€¥",value:"CRITICAL"})]),_:1},8,["modelValue"])]),_:1}),a(E,{label:"æ—¶é—´èŒƒå›´"},{default:c(()=>[a(A,{modelValue:o.value.timeRange,"onUpdate:modelValue":v[3]||(v[3]=V=>o.value.timeRange=V),type:"datetimerange","range-separator":"è‡³","start-placeholder":"å¼€å§‹æ—¶é—´","end-placeholder":"ç»“æŸæ—¶é—´",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DDTHH:mm:ss",style:{width:"350px"}},null,8,["modelValue"])]),_:1}),a(E,null,{default:c(()=>[a(ne,{type:"primary",onClick:b},{default:c(()=>[a(te,null,{default:c(()=>[a(j(bn))]),_:1}),v[10]||(v[10]=M(" æœç´¢ ",-1))]),_:1}),a(ne,{onClick:f},{default:c(()=>[a(te,null,{default:c(()=>[a(j(To))]),_:1}),v[11]||(v[11]=M(" é‡ç½® ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(ze,{gutter:20},{default:c(()=>[a(Ue,{xs:24,sm:24,md:16,lg:16,xl:16},{default:c(()=>[a(z,{class:"event-list-section",shadow:"hover"},{header:c(()=>[l("div",Bi,[v[12]||(v[12]=l("span",null,"äº‹ä»¶åˆ—è¡¨",-1)),l("div",Hi," å…± "+S(j(t).events.length)+" æ¡è®°å½• ",1)])]),default:c(()=>[zt((L(),ue(pe,{data:j(t).events,stripe:"",style:{width:"100%"},onRowClick:x},{default:c(()=>[a(Y,{prop:"timestamp",label:"æ—¶é—´",width:"180"},{default:c(({row:V})=>[M(S(J(V.timestamp)),1)]),_:1}),a(Y,{prop:"deviceId",label:"è®¾å¤‡ID",width:"150"}),a(Y,{prop:"username",label:"é©¾é©¶å‘˜",width:"120"},{default:c(({row:V})=>[M(S(V.user?.username||"æœªçŸ¥"),1)]),_:1}),a(Y,{prop:"eventType",label:"äº‹ä»¶ç±»å‹",width:"120"},{default:c(({row:V})=>[a(X,{type:se(V.eventType),size:"small"},{default:c(()=>[M(S(oe(V.eventType)),1)]),_:2},1032,["type"])]),_:1}),a(Y,{prop:"severity",label:"ä¸¥é‡ç¨‹åº¦",width:"100"},{default:c(({row:V})=>[a(X,{type:ye(V.severity),size:"small"},{default:c(()=>[M(S(me(V.severity)),1)]),_:2},1032,["type"])]),_:1}),a(Y,{prop:"confidence",label:"ç½®ä¿¡åº¦",width:"100"},{default:c(({row:V})=>[M(S(V.confidence?(V.confidence*100).toFixed(1)+"%":"æœªçŸ¥"),1)]),_:1}),a(Y,{prop:"duration",label:"æŒç»­æ—¶é—´",width:"100"},{default:c(({row:V})=>[M(S(V.duration?V.duration+"ç§’":"æœªçŸ¥"),1)]),_:1}),a(Y,{prop:"context",label:"æè¿°","min-width":"200","show-overflow-tooltip":""}),a(Y,{label:"æ“ä½œ",width:"120",fixed:"right"},{default:c(({row:V})=>[a(ne,{size:"small",onClick:gn(Be=>O(V),["stop"])},{default:c(()=>[...v[13]||(v[13]=[M(" è¯¦æƒ… ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Ke,j(t).loading]]),l("div",Vi,[a(Se,{"current-page":s.value.currentPage,"onUpdate:currentPage":v[4]||(v[4]=V=>s.value.currentPage=V),"page-size":s.value.pageSize,"onUpdate:pageSize":v[5]||(v[5]=V=>s.value.pageSize=V),"page-sizes":[10,20,50,100],total:s.value.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:N,onCurrentChange:U},null,8,["current-page","page-size","total"])])]),_:1})]),_:1}),a(Ue,{xs:24,sm:24,md:8,lg:8,xl:8},{default:c(()=>[a(z,{class:"statistics-section",shadow:"hover"},{header:c(()=>[...v[14]||(v[14]=[l("span",null,"äº‹ä»¶ç»Ÿè®¡å›¾è¡¨",-1)])]),default:c(()=>[a(xn,{data:j(t).events,loading:j(t).loading,onPeriodChange:K},null,8,["data","loading"])]),_:1}),a(z,{class:"severity-section",shadow:"hover"},{header:c(()=>[...v[15]||(v[15]=[l("span",null,"ä¸¥é‡ç¨‹åº¦åˆ†å¸ƒ",-1)])]),default:c(()=>[l("div",Wi,[(L(!0),H(Le,null,Pe(_.value,(V,Be)=>(L(),H("div",{key:Be,class:"severity-item"},[l("div",ji,[a(X,{type:ye(Be),size:"small"},{default:c(()=>[M(S(me(Be)),1)]),_:2},1032,["type"])]),l("div",qi,S(V),1),l("div",Gi,S(be(V))+"% ",1)]))),128))])]),_:1}),a(z,{class:"device-stats-section",shadow:"hover"},{header:c(()=>[...v[16]||(v[16]=[l("span",null,"è®¾å¤‡äº‹ä»¶ç»Ÿè®¡",-1)])]),default:c(()=>[l("div",Ki,[(L(!0),H(Le,null,Pe(u.value,V=>(L(),H("div",{key:V.deviceId,class:"device-stat-item"},[l("div",Ji,[l("div",Yi,S(V.deviceId),1),l("div",Xi,S(V.username),1)]),l("div",Qi,S(V.eventCount),1)]))),128))])]),_:1})]),_:1})]),_:1}),a(fe,{modelValue:i.value,"onUpdate:modelValue":v[6]||(v[6]=V=>i.value=V),title:"äº‹ä»¶è¯¦æƒ…",width:"800px"},{default:c(()=>[r.value?(L(),H("div",Zi,[a(Ge,{column:2,border:""},{default:c(()=>[a(he,{label:"äº‹ä»¶ID"},{default:c(()=>[M(S(r.value.eventId),1)]),_:1}),a(he,{label:"è®¾å¤‡ID"},{default:c(()=>[M(S(r.value.deviceId),1)]),_:1}),a(he,{label:"é©¾é©¶å‘˜"},{default:c(()=>[M(S(r.value.user?.username||"æœªçŸ¥"),1)]),_:1}),a(he,{label:"è”ç³»æ–¹å¼"},{default:c(()=>[M(S(r.value.user?.phone||"æœªçŸ¥"),1)]),_:1}),a(he,{label:"äº‹ä»¶ç±»å‹"},{default:c(()=>[M(S(oe(r.value.eventType)),1)]),_:1}),a(he,{label:"ä¸¥é‡ç¨‹åº¦"},{default:c(()=>[M(S(me(r.value.severity)),1)]),_:1}),a(he,{label:"ç½®ä¿¡åº¦"},{default:c(()=>[M(S((r.value.confidence*100).toFixed(1))+"%",1)]),_:1}),a(he,{label:"æŒç»­æ—¶é—´"},{default:c(()=>[M(S(r.value.duration)+"ç§’",1)]),_:1}),a(he,{label:"å‘ç”Ÿæ—¶é—´",span:2},{default:c(()=>[M(S(J(r.value.timestamp)),1)]),_:1}),a(he,{label:"ä½ç½®",span:2},{default:c(()=>[M(S(Z(r.value.location)),1)]),_:1}),a(he,{label:"è¡Œä¸ºæè¿°",span:2},{default:c(()=>[M(S(r.value.behavior),1)]),_:1}),a(he,{label:"ä¸Šä¸‹æ–‡",span:2},{default:c(()=>[M(S(r.value.context),1)]),_:1})]),_:1})])):ae("",!0)]),_:1},8,["modelValue"])])}}},tc=Ce(ec,[["__scopeId","data-v-74d57346"]]),nc=[{path:"/",redirect:"/dashboard"},{path:"/dashboard",name:"Dashboard",component:Yr,meta:{title:"å®æ—¶ç›‘æ§ä»ªè¡¨æ¿"}},{path:"/devices/:deviceId",name:"DeviceDetail",component:Fi,meta:{title:"è®¾å¤‡è¯¦æƒ…"}},{path:"/events",name:"EventManagement",component:tc,meta:{title:"äº‹ä»¶ç®¡ç†"}},{path:"/alerts",name:"AlertCenter",component:()=>Je(()=>import("./AlertCenter-B97TkA5U.js"),__vite__mapDeps([0,1,2,3,4])),meta:{title:"å‘Šè­¦ä¸­å¿ƒ"}},{path:"/analytics",name:"Analytics",component:()=>Je(()=>import("./Analytics-y_hVxKiQ.js"),__vite__mapDeps([5,2,1,3,6])),meta:{title:"æ•°æ®åˆ†æ"}},{path:"/users",name:"UserManagement",component:()=>Je(()=>import("./UserManagement-PX_9j0gP.js"),__vite__mapDeps([7,1,2,3,8])),meta:{title:"ç”¨æˆ·ç®¡ç†"}},{path:"/websocket-test",name:"WebSocketTest",component:()=>Je(()=>import("./WebSocketTest-DzX1Zugj.js"),__vite__mapDeps([9,1,2,3,10])),meta:{title:"WebSocketæµ‹è¯•"}},{path:"/map-config-help",name:"MapConfigHelp",component:()=>Je(()=>import("./MapConfigHelp-C8lT4Bfa.js"),__vite__mapDeps([11,1,2,3,12])),meta:{title:"åœ°å›¾é…ç½®å¸®åŠ©"}}],to=io({history:co(),routes:nc});to.beforeEach((e,t,n)=>{e.meta.title&&(document.title=`${e.meta.title} - Muse äº‘ç«¯å®æ—¶æ£€æµ‹å¹³å°`),n()});const ot=uo(No);for(const[e,t]of Object.entries(ko))ot.component(e,t);ot.use(fo());ot.use(to);ot.use(Ao);ot.mount("#app");export{Dt as D,xn as E,ls as F,Ot as H,rt as S,Ce as _,vt as a,jt as b,we as r,Nl as u,le as w};
